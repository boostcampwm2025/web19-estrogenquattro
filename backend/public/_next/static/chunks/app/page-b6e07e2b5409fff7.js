(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{486:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(546);let r=(0,s(3059).default)(()=>Promise.resolve(({children:e})=>(0,a.jsx)(a.Fragment,{children:e})),{ssr:!1})},807:(e,t,s)=>{"use strict";function a(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${a}`}function r(e){let t=new Date(e);t.setHours(0,0,0,0);let s=new Date(e);return s.setHours(23,59,59,999),{startAt:t.toISOString(),endAt:s.toISOString()}}function i(){let e=new Date;return e.setHours(0,0,0,0),e.toISOString()}function n(e){return new Date(e+"T00:00:00")}function l(e){let t=Math.floor(e/60),s="⏱️";if(t<60)s+=`${t}분`;else{let e=Math.floor(t/60),a=t%60;s+=`${e}시간`,a>0&&(s+=` ${a}분`)}return s}function o(e){let t=e.getFullYear(),s=e.getMonth()+1,a=e.getDate(),r=["일","월","화","수","목","금","토"][e.getDay()];return`${t}년 ${s}월 ${String(a).padStart(2,"0")}일 ${r}`}function c(){let e=new Date,t=e.getDay(),s=new Date(e);return s.setDate(e.getDate()+(0===t?-6:1-t)),s.setHours(0,0,0,0),s.toISOString()}function d(){let e=new Date(c());return e.setDate(e.getDate()+7),e.toISOString()}s.d(t,{DF:()=>i,FT:()=>l,HN:()=>a,Zj:()=>n,aJ:()=>d,n1:()=>r,pD:()=>o,vc:()=>c})},820:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var a=s(546),r=s(5778),i=s(2983),n=s(7335),l=s(9873);function o(){let{openModal:e}=(0,n.K)((0,i.k)(e=>({openModal:e.openModal}))),{user:t}=(0,l.n)();return t?(0,a.jsx)("button",{id:"user-info-button",onClick:()=>{t&&e(n.e.USER_INFO,{playerId:t.playerId,username:t.username})},className:"flex h-12 w-12 cursor-pointer items-center justify-center border-3 border-amber-900 bg-[#ffecb3] shadow-[4px_4px_0px_0px_rgba(0,0,0,0.5)] transition-all hover:bg-amber-100 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none","aria-label":"내 프로필 열기",children:(0,a.jsx)(r.A,{className:"h-6 w-6 text-amber-900"})}):null}},1217:(e,t,s)=>{"use strict";s.d(t,{fB:()=>c,yu:()=>u,iZ:()=>d.iZ,Pe:()=>x,wu:()=>n,si:()=>m});var a=s(9141),r=s(4816),i=s(3532);function n(e){let{data:t,isLoading:s,error:n,refetch:l}=(0,r.I)({queryKey:a.l.points.list(e),queryFn:()=>i.l.getPoints(e,new Date().toISOString()),enabled:e>0,staleTime:0});return{points:t??[],isLoading:s,error:n,refetch:l}}var l=s(6375),o=s(807);function c(e,t){let s=(0,o.Zj)(t),{startAt:i,endAt:n}=(0,o.n1)(s),{data:c,isLoading:d,error:h,refetch:m}=(0,r.I)({queryKey:a.l.focustime.detail(e,t),queryFn:()=>l.Q.getFocusTime(e,i,n),enabled:e>0&&!!t,staleTime:0});return{focustime:c,isLoading:d,error:h,refetch:m}}var d=s(4189),h=s(8087);function m(e,t){let s=t?(0,o.Zj)(t):new Date,i=(0,o.HN)(s),{startAt:n,endAt:l}=(0,o.n1)(s),c=i===(0,o.HN)(new Date),{data:d,isLoading:m,error:u,refetch:p}=(0,r.I)({queryKey:a.l.tasks.list(e,i),queryFn:()=>h.W.getTasks(e,c,n,l),enabled:e>0,staleTime:0});return{tasks:d?.tasks??[],isLoading:m,error:u,refetch:p}}function u(e,t){let s=(0,o.HN)(t),{startAt:n,endAt:l}=(0,o.n1)(t),{data:c,isLoading:d,error:h}=(0,r.I)({queryKey:a.l.points.gitEventHistories(e,s),queryFn:()=>i.l.getGitEventHistories(e,n,l),enabled:!!e,staleTime:0});return{gitEvents:c??[],isLoading:d,error:h}}var p=s(2393);function x(e,t,s=!0){let{data:n,isLoading:l,error:o,refetch:c}=(0,r.I)({queryKey:a.l.leaderboard.ranks(e,t),queryFn:()=>t===p.vk.ALL?i.l.getRanks(e):i.l.getHistoryRanks(e,t),enabled:s,staleTime:0,refetchOnMount:"always"});return{ranks:n??[],isLoading:l,error:o,refetch:c,isAllType:t===p.vk.ALL}}},2005:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(546),r=s(2463),i=s(842),n=s(8169),l=s(2312);let o=["/assets/medal/gold.webp","/assets/medal/silver.webp","/assets/medal/bronze.webp"];function c(){let e=Object.entries((0,l.$)(e=>e.contributions)).sort(([,e],[,t])=>t-e).slice(0,3);return 0===e.length?null:(0,a.jsx)("div",{className:"mt-1 flex items-center justify-center gap-3",children:e.map(([e],t)=>(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.default,{src:o[t],alt:`${t+1}등 메달`,width:20,height:20,className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-neodunggeunmo text-sm font-bold text-white",style:{textShadow:`
                -1px -1px 0 black,
                1px -1px 0 black,
                -1px 1px 0 black,
                1px 1px 0 black
              `},children:e})]},e))})}function d(){let e=(0,r.M)(e=>e.progress),t=(0,r.M)(e=>e.mapIndex),s=(0,r.M)(e=>e.progressThreshold),[n,l]=(0,i.useState)(0),o=t>=4;(0,i.useEffect)(()=>{let t,s=Date.now(),a=()=>{let r=Math.min((Date.now()-s)/300,1),i=n+(e-n)*(1-Math.pow(1-r,3));r>=1?l(e):(l(i),t=requestAnimationFrame(a))};return t=requestAnimationFrame(a),()=>{t&&cancelAnimationFrame(t)}},[e]);let d=o?100:Math.min(n/s*100,100),h=Math.floor(d/100*24),m=(d/100*24-h)*100,u=o?"STAGE COMPLETE!":`NEXT STAGE LOADING... (${t+1}/5)`;return(0,a.jsxs)("div",{id:"progress-bar-container",className:"fixed top-4 left-1/2 z-[50] flex -translate-x-1/2 flex-col items-center",children:[(0,a.jsx)("span",{className:"font-neodunggeunmo text-xl font-bold text-white",style:{textShadow:`
            -1px -1px 0 black,
            1px -1px 0 black,
            -1px 1px 0 black,
            1px 1px 0 black
          `},children:u}),(0,a.jsxs)("div",{className:"relative flex items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"})]}),(0,a.jsxs)("div",{className:"flex flex-col",style:{marginLeft:"-5px"},children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] bg-black",style:{width:"285px"}}),(0,a.jsx)("div",{className:"flex h-[24px] items-center gap-[3px] bg-white",children:Array.from({length:24}).map((e,t)=>{let s=0;return d>=100?s=100:d<=0?s=0:t<h?s=100:t===h&&(s=m),(0,a.jsx)("div",{className:"relative h-[16px] w-[9px] overflow-hidden bg-white",children:(0,a.jsx)("div",{className:"absolute inset-0 transition-all duration-150",style:{width:`${s}%`,backgroundColor:"#22c55e"}})},t)})}),(0,a.jsx)("div",{className:"h-[4px] bg-black",style:{width:"285px"}})]}),(0,a.jsxs)("div",{className:"flex flex-col",style:{marginLeft:"-5px"},children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-white"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-black"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"}),(0,a.jsx)("div",{className:"h-[4px] w-[4px] bg-transparent"})]})]}),(0,a.jsx)(c,{})]})}},2177:(e,t,s)=>{"use strict";s.d(t,{default:()=>z});var a=s(546),r=s(842),i=s(6743),n=s(9151),l=s(6258),o=s(8819),c=s(4693),d=s(579),h=s(3393),m=s(4958),u=s(982),p=s(7999),x=s(1879),g=s(133),b=s(8986);let f=[{id:"1",title:"Ice Cave",artist:"Lo-Fi",src:"/assets/music/lo-fi/8_bit_ice_cave_lofi.mp3"},{id:"2",title:"A Cup of Tea",artist:"Lo-Fi",src:"/assets/music/lo-fi/A cup of tea.mp3"},{id:"3",title:"Bartender",artist:"Lo-Fi",src:"/assets/music/lo-fi/Bartender.mp3"},{id:"4",title:"Cat Caffe",artist:"Lo-Fi",src:"/assets/music/lo-fi/Cat caffe.mp3"},{id:"5",title:"Chill Lofi R",artist:"Lo-Fi",src:"/assets/music/lo-fi/ChillLofiR.mp3"},{id:"6",title:"Countryside",artist:"Lo-Fi",src:"/assets/music/lo-fi/Countryside.mp3"},{id:"7",title:"Cue",artist:"Lo-Fi",src:"/assets/music/lo-fi/Cue.mp3"},{id:"8",title:"Florist",artist:"Lo-Fi",src:"/assets/music/lo-fi/Florist.mp3"},{id:"9",title:"Lofi Loop",artist:"Lo-Fi",src:"/assets/music/lo-fi/LofiLoop.mp3"},{id:"10",title:"Morning Rain",artist:"Lo-Fi",src:"/assets/music/lo-fi/Morning rain.mp3"},{id:"11",title:"Oceanside",artist:"Lo-Fi",src:"/assets/music/lo-fi/Oceanside.mp3"},{id:"12",title:"Rainy Forest",artist:"Lo-Fi",src:"/assets/music/lo-fi/Rainy Forest.mp3"},{id:"13",title:"Lofi Hiphop",artist:"Lo-Fi",src:"/assets/music/lo-fi/lofihiphop.mp3"}],v="musicPlayer_volume",y="musicPlayer_loopMode",w="musicPlayer_lastTrackId";function j(){let e=localStorage.getItem(v);if(null===e)return .5;let t=parseFloat(e);return Number.isNaN(t)?.5:Math.max(0,Math.min(1,t))}function N(){let e=localStorage.getItem(y);return"OFF"===e||"ALL"===e||"ONE"===e?e:"ALL"}function S(){let e=localStorage.getItem(w);return e&&f.find(t=>t.id===e)||null}function k({isExpanded:e}){let{isPlaying:t,currentTrack:s,volume:i,setVolume:n,isMuted:l,setIsMuted:o,audioRef:k,handlePlayTrack:T,handleTogglePlay:_,handleNext:I,handlePrev:E,handleTrackEnd:C,loopMode:M,toggleLoopMode:P}=function(){let[e,t]=(0,r.useState)(!0),[s,a]=(0,r.useState)(!1),[i,n]=(0,r.useState)(S),[l,o]=(0,r.useState)(j),[c,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(N),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{u.current&&(u.current.volume=c?0:l)},[l,c]),(0,r.useEffect)(()=>{localStorage.setItem(v,String(l))},[l]),(0,r.useEffect)(()=>{localStorage.setItem(y,h)},[h]),(0,r.useEffect)(()=>{i&&localStorage.setItem(w,i.id)},[i]),(0,r.useEffect)(()=>{u.current&&i&&(s?u.current.play():u.current.pause())},[s,i]),(0,r.useEffect)(()=>{let e=(0,b.Ol)();e&&e.connected&&e.emit("music_status",{isListening:s});let t=new CustomEvent("local_music_update",{detail:{isListening:s}});window.dispatchEvent(t)},[s]),(0,r.useEffect)(()=>{let e=()=>{a(!1)};return window.addEventListener("reset_media",e),()=>{window.removeEventListener("reset_media",e)}},[]);let p=()=>{if(!i){n(f[0]),a(!0);return}let e=(f.findIndex(e=>e.id===i.id)+1)%f.length;n(f[e]),a(!0)};return{isExpanded:e,setIsExpanded:t,isPlaying:s,currentTrack:i,volume:l,setVolume:o,isMuted:c,setIsMuted:d,audioRef:u,handlePlayTrack:e=>{i?.id===e.id?a(!s):(n(e),a(!0))},handleTogglePlay:()=>{!i&&f.length>0?(n(f[0]),a(!0)):a(!s)},handleNext:p,handlePrev:()=>{if(!i){n(f[0]),a(!0);return}let e=f.findIndex(e=>e.id===i.id),t=e<=0?f.length-1:e-1;n(f[t]),a(!0)},handleTrackEnd:()=>{if("ONE"===h)u.current&&(u.current.currentTime=0,u.current.play());else if("OFF"===h){if(!i)return;f.findIndex(e=>e.id===i.id)===f.length-1?a(!1):p()}else p()},loopMode:h,toggleLoopMode:()=>{m(e=>"OFF"===e?"ALL":"ALL"===e?"ONE":"OFF")}}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("audio",{ref:k,src:s?.src,onEnded:C,onCanPlay:()=>{if(t&&k.current){let e=k.current.play();e&&e.catch(()=>{})}}}),(0,a.jsxs)("div",{className:e?"block":"hidden",children:[(0,a.jsx)("section",{className:"mb-3 border-2 border-amber-900 bg-white/50 p-2","aria-label":"Now Playing",children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"truncate text-xs font-bold text-amber-900",children:["♪ ",s.title]}),(0,a.jsx)("p",{className:"truncate text-xs text-amber-700",children:s.artist})]}):(0,a.jsx)("p",{className:"truncate text-xs font-bold text-amber-700",children:"♪ 재생 중인 곡 없음"})}),(0,a.jsxs)("div",{className:"mb-3 flex items-center justify-between",role:"group","aria-label":"Playback Controls",children:[(0,a.jsx)("button",{onClick:P,"aria-label":`Repeat Mode: ${M}`,className:`flex h-8 w-8 cursor-pointer items-center justify-start transition-colors ${"OFF"===M?"text-amber-500 hover:text-amber-900":"text-amber-900"}`,children:"ONE"===M?(0,a.jsx)(c.A,{className:"h-4 w-4"}):(0,a.jsx)(d.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:E,"aria-label":"Previous Track",className:"border-retro-border-dark bg-retro-button-bg hover:bg-retro-button-hover flex h-8 w-8 cursor-pointer items-center justify-center border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.3)] active:translate-x-[1px] active:translate-y-[1px] active:shadow-none",children:(0,a.jsx)(h.A,{className:"text-retro-button-text h-3 w-3"})}),(0,a.jsx)("button",{onClick:_,"aria-label":t?"Pause":"Play",className:"border-retro-border-dark bg-retro-button-bg hover:bg-retro-button-hover flex h-8 w-8 cursor-pointer items-center justify-center border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.3)] active:translate-x-px active:translate-y-px active:shadow-none",children:t?(0,a.jsx)(m.A,{className:"text-retro-button-text h-4 w-4"}):(0,a.jsx)(u.A,{className:"text-retro-button-text h-4 w-4"})}),(0,a.jsx)("button",{onClick:I,"aria-label":"Next Track",className:"border-retro-border-dark bg-retro-button-bg hover:bg-retro-button-hover flex h-8 w-8 cursor-pointer items-center justify-center border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.3)] active:translate-x-px active:translate-y-px active:shadow-none",children:(0,a.jsx)(p.A,{className:"text-retro-button-text h-3 w-3"})})]}),(0,a.jsx)("div",{className:"w-8","aria-hidden":"true"})]}),(0,a.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>o(!l),"aria-label":l||0===i?"Unmute":"Mute",className:"cursor-pointer text-amber-900 hover:text-amber-700",children:l||0===i?(0,a.jsx)(x.A,{className:"h-4 w-4"}):(0,a.jsx)(g.A,{className:"h-4 w-4"})}),(0,a.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:i,onChange:e=>{n(parseFloat(e.target.value)),l&&o(!1)},"aria-label":"Volume Control",className:"h-2 flex-1 cursor-pointer appearance-none bg-amber-300/60 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:bg-amber-700"})]}),(0,a.jsx)("ul",{className:"retro-scrollbar max-h-32 overflow-y-auto border-2 border-amber-900 bg-white/50",children:f.map(e=>(0,a.jsx)("li",{onClick:()=>T(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),T(e))},role:"button",tabIndex:0,className:`cursor-pointer p-2 last:border-b-0 ${s?.id===e.id?"bg-retro-button-bg/10":"hover:bg-amber-100"}`,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s?.id===e.id&&t?(0,a.jsx)("span",{className:"text-xs text-amber-900","aria-hidden":"true",children:"▶"}):(0,a.jsx)("span",{className:"text-xs opacity-0","aria-hidden":"true",children:"▶"}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"truncate text-xs font-bold text-amber-900",children:e.title}),(0,a.jsx)("p",{className:"truncate text-xs text-amber-700",children:e.artist})]})]})},e.id))})]}),(0,a.jsx)("div",{className:e?"hidden":"block",children:s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),_()},"aria-label":t?"Pause":"Play",className:"cursor-pointer text-amber-900 hover:text-amber-700",children:t?(0,a.jsx)(m.A,{className:"h-4 w-4"}):(0,a.jsx)(u.A,{className:"h-4 w-4"})}),(0,a.jsxs)("p",{className:"flex-1 truncate text-sm font-semibold text-amber-900",children:["♪ ",s.title]})]}):(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("p",{className:"text-sm text-amber-700",children:"재생 중인 곡 없음"})})})]})}var T=s(8601);function _({message:e}){return e?(0,a.jsx)("div",{role:"alert",className:"border-retro-border-darkest bg-retro-border-light text-retro-delete-hover shadow-retro-sm mb-3 rounded-none border-2 px-3 py-2 text-xs",children:e}):null}function I({time:e,isRunning:t,onToggle:s,error:r}){return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"text-md mb-3 text-amber-900",children:"[ Focus Time ]"}),(0,a.jsx)(_,{message:r}),(0,a.jsx)("div",{className:"mb-4 rounded-none border-3 border-amber-900 bg-white/50 p-6 shadow-[4px_4px_0px_0px_rgba(0,0,0,0.3)]",children:(0,a.jsx)("div",{className:"text-center text-3xl text-amber-900",children:e})}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(T.$,{onClick:s,className:"text-md border-retro-border-darker bg-retro-button-bg text-retro-button-text shadow-retro-lg hover:bg-retro-button-hover flex flex-1 items-center justify-center gap-2 rounded-none border-2 py-1 transition-all active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),"정지"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),"시작"]})})})]})}var E=s(364),C=s(1696),M=s(4652),P=s(3798),D=s(5371),A=s(249);function R({checked:e=!1,disabled:t=!1,onCheckedChange:s,className:r=""}){return(0,a.jsx)("input",{type:"checkbox",checked:e,disabled:t,onChange:e=>s?.(e.target.checked),className:r})}function F({className:e="",...t}){return(0,a.jsx)("input",{className:e,...t})}function L({task:e,displayTime:t,isPending:s,onToggle:i,onDelete:n,onToggleTimer:l,onEdit:o,formatTime:c}){let[d,h]=(0,r.useState)(!1),[p,x]=(0,r.useState)(e.description),g=t=>{t.preventDefault(),!s&&p.trim()&&(o(e.id,p.trim()),h(!1))},b=()=>{x(e.description),h(!1)};return(0,a.jsxs)("div",{className:"group flex items-center gap-3 rounded-none border-2 border-amber-900 bg-white/50 px-3 py-3 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.2)] transition-colors hover:border-amber-800",children:[(0,a.jsx)(R,{checked:e.completed,disabled:s,onCheckedChange:()=>i(e.id),className:"h-5 w-5 rounded-none border-2 border-amber-900 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:border-amber-900 data-[state=checked]:bg-amber-600"}),(0,a.jsx)("div",{className:"min-w-0 flex-1",children:d?(0,a.jsx)(F,{type:"text",value:p,onChange:e=>x(e.target.value),onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key&&g(e),"Escape"===e.key&&b()},className:"h-8 w-full rounded-none border-2 border-amber-900 bg-white px-2 text-sm text-amber-900 disabled:cursor-not-allowed disabled:opacity-50",autoFocus:!0,disabled:s}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:`text-sm ${e.completed?"text-amber-500 line-through":"text-amber-900"}`,children:e.description}),(0,a.jsx)("div",{className:"mt-0.5 text-xs text-amber-700",children:c(t)})]})}),s&&(0,a.jsx)(P.A,{className:"h-4 w-4 animate-spin text-amber-700"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.$,{type:"button",disabled:s,"aria-label":"작업 수정 저장",className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-none border-2 border-amber-800 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] transition-all hover:bg-amber-800 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none disabled:cursor-not-allowed disabled:opacity-50",onClick:g,children:(0,a.jsx)(C.A,{className:"h-4 w-4"})}),(0,a.jsx)(T.$,{type:"button",disabled:s,"aria-label":"작업 수정 취소",className:"border-retro-border-darker bg-retro-button-bg text-retro-button-text shadow-retro-lg hover:bg-retro-button-hover ml-1 flex h-7 w-7 items-center justify-center rounded-none border-2 transition-all active:translate-x-0.5 active:translate-y-0.5 active:shadow-none disabled:cursor-not-allowed disabled:opacity-50",onClick:b,children:(0,a.jsx)(M.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.$,{disabled:s,"aria-label":e.isRunning?"타이머 일시정지":"타이머 시작","aria-pressed":e.isRunning,className:`flex h-8 w-8 items-center justify-center rounded-none border-2 transition-all ${e.isRunning?"border-amber-900 bg-amber-600 text-white hover:bg-amber-700":"border-amber-900/50 bg-transparent text-amber-700 hover:bg-amber-100 hover:text-amber-900"} disabled:cursor-not-allowed disabled:opacity-50`,onClick:()=>l(e.id),children:e.isRunning?(0,a.jsx)(m.A,{className:"h-4 w-4"}):(0,a.jsx)(u.A,{className:"h-4 w-4"})}),(0,a.jsx)(T.$,{disabled:s,"aria-label":"작업 편집",className:"flex h-8 w-8 items-center justify-center rounded-none border-2 border-amber-900/50 bg-transparent text-amber-700 transition-all hover:bg-amber-100 hover:text-amber-900 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>{h(!0),x(e.description)},children:(0,a.jsx)(D.A,{className:"h-4 w-4"})}),(0,a.jsx)(T.$,{disabled:s,"aria-label":"작업 삭제",className:"flex h-8 w-8 items-center justify-center rounded-none border-2 border-amber-900/50 bg-transparent text-amber-700 transition-all hover:bg-amber-100 hover:text-amber-900 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>n(e.id),children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})]})})]})}function $({tasks:e,completedCount:t,totalCount:s,error:i,pendingTaskIds:n,onAddTask:l,onToggleTask:o,onDeleteTask:c,onToggleTaskTimer:d,onEditTask:h,formatTaskTime:m,getTaskDisplayTime:u}){let[p,x]=(0,r.useState)(""),[g,b]=(0,r.useState)(!1),f=(0,r.useRef)(null);return(0,r.useEffect)(()=>{f.current&&f.current.scrollTo({top:f.current.scrollHeight,behavior:"smooth"})},[e.length]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-md text-amber-900",children:"[ Tasks ]"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm text-amber-900",children:[t,"/",s]}),(0,a.jsx)(T.$,{onClick:()=>{b(!0)},className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-none border-2 border-amber-800 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] transition-all hover:bg-amber-800 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:(0,a.jsx)(E.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(_,{message:i}),g&&(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),p.trim()&&(l(p.trim()),x(""),b(!1))},className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(F,{type:"text",value:p,onChange:e=>x(e.target.value),onKeyDown:e=>e.stopPropagation(),placeholder:"새 작업...",className:"flex-1 rounded-none border-2 border-amber-900 bg-white px-3 py-1 text-sm text-amber-900 placeholder:text-amber-500",autoFocus:!0}),(0,a.jsx)(T.$,{type:"submit",className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-none border-2 border-amber-800 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] transition-all hover:bg-amber-800 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:(0,a.jsx)(C.A,{className:"h-4 w-4"})}),(0,a.jsx)(T.$,{type:"button",className:"border-retro-border-darker bg-retro-button-bg text-retro-button-text shadow-retro-lg hover:bg-retro-button-hover flex h-7 w-7 items-center justify-center rounded-none border-2 transition-all active:translate-x-0.5 active:translate-y-0.5 active:shadow-none disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>{x(""),b(!1)},children:(0,a.jsx)(M.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)("div",{ref:f,className:"retro-scrollbar max-h-72 space-y-2 overflow-y-auto",children:e.map(e=>(0,a.jsx)(L,{task:e,displayTime:u(e),isPending:n.includes(e.id),onToggle:o,onDelete:c,onToggleTimer:d,onEdit:h,formatTime:m},e.id))})]})}let O=e=>{let t=Math.floor(e/3600),s=Math.floor(e%3600/60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`},K=e=>{let t=Math.floor(e/3600),s=Math.floor(e%3600/60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`};var q=s(4563),U=s(5963),G=s(2983);function B({isExpanded:e,lastRunTaskId:t,setLastRunTaskId:s}){let{tasks:i,isLoading:n,error:l,pendingTaskIds:o,fetchTasks:c,addTask:d,toggleTask:h,deleteTask:p,editTask:x,toggleTaskTimer:g,stopAllTasks:b,getTaskDisplayTime:f,clearTaskError:v,removeCompletedTasks:y}=(0,U.d)((0,G.k)(e=>({tasks:e.tasks,isLoading:e.isLoading,error:e.error,pendingTaskIds:e.pendingTaskIds,fetchTasks:e.fetchTasks,addTask:e.addTask,toggleTask:e.toggleTask,deleteTask:e.deleteTask,editTask:e.editTask,toggleTaskTimer:e.toggleTaskTimer,stopAllTasks:e.stopAllTasks,getTaskDisplayTime:e.getTaskDisplayTime,clearTaskError:e.clearError,removeCompletedTasks:e.removeCompletedTasks})));(0,r.useEffect)(()=>{c()},[c]),(0,r.useEffect)(()=>{let e=()=>{let s,a,r=((a=new Date(s=new Date)).setUTCHours(15,0,0,0),s.getUTCHours()>=15&&a.setUTCDate(a.getUTCDate()+1),a.getTime()-s.getTime());return window.setTimeout(()=>{y(),t=e()},r)},t=e();return()=>window.clearTimeout(t)},[y]),(0,r.useEffect)(()=>{if(!l)return;let e=window.setTimeout(()=>{v()},3e3);return()=>{window.clearTimeout(e)}},[l,v]);let w=(0,r.useMemo)(()=>i.filter(e=>e.completed).length,[i]),j=(0,r.useMemo)(()=>i.find(e=>e.isRunning),[i]),N=(0,r.useMemo)(()=>j||i.find(e=>e.id===t),[j,i,t]),{getFocusTime:S,baseFocusSeconds:k,isFocusTimerRunning:T,startFocusing:_,stopFocusing:E,focusError:C,clearFocusError:M}=(0,q.O)((0,G.k)(e=>({getFocusTime:e.getFocusTime,baseFocusSeconds:e.baseFocusSeconds,isFocusTimerRunning:e.isFocusTimerRunning,startFocusing:e.startFocusing,stopFocusing:e.stopFocusing,focusError:e.error,clearFocusError:e.clearError}))),P=T||!!j,[D,A]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(!P)return;let e=window.setInterval(()=>A(e=>e+1),1e3);return()=>clearInterval(e)},[P]),(0,r.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&A(e=>e+1)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]);let R=(0,r.useMemo)(()=>S(),[D,T,k,S]);(0,r.useEffect)(()=>{if(!C)return;let e=window.setTimeout(()=>{M()},3e3);return()=>{window.clearTimeout(e)}},[C,M]);let F=()=>{P?(E(),b()):(_(),s(null))},L=e=>{let t=i.find(t=>t.id===e);t&&t.isRunning?E():(_(t?.description,t?.id),s(e),t?.completed&&h(e)),g(e)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:e?"block":"hidden",children:[(0,a.jsx)(I,{time:O(R),isRunning:P,onToggle:F,error:C}),(0,a.jsx)($,{tasks:i,completedCount:w,totalCount:i.length,onAddTask:d,onToggleTask:e=>{let t=i.find(t=>t.id===e);t?.isRunning&&(E(),g(e)),h(e)},onDeleteTask:p,onToggleTaskTimer:L,onEditTask:x,formatTaskTime:K,getTaskDisplayTime:f,error:l,pendingTaskIds:o})]}),(0,a.jsx)("div",{className:e?"hidden":"block",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),N?L(N.id):F()},className:"cursor-pointer text-amber-900 hover:text-amber-700","aria-label":P?"정지":"시작",children:P?(0,a.jsx)(m.A,{className:"h-5 w-5"}):(0,a.jsx)(u.A,{className:"h-5 w-5"})}),(0,a.jsx)("div",{className:"flex-1 truncate",children:N?(0,a.jsx)("p",{className:"truncate text-sm font-semibold text-amber-900",children:N.description}):(0,a.jsx)("p",{className:"text-sm text-amber-700",children:"Task를 선택해주세요"})}),(0,a.jsx)("span",{className:"font-mono text-sm text-amber-900",children:O(R)})]})})]})}let W="tasks",H="music";function z(){let[e,t]=(0,r.useState)(W),[s,c]=(0,r.useState)(!0),[d,h]=(0,r.useState)(null);return(0,a.jsx)("div",{id:"focus-panel",className:"w-80",children:(0,a.jsxs)("div",{className:"border-3 border-amber-900 bg-[#ffecb3] shadow-[8px_8px_0px_0px_rgba(0,0,0,0.5)]",children:[(0,a.jsx)("div",{className:"flex items-center p-4 pb-0 select-none",children:(0,a.jsxs)("div",{className:"flex flex-1 gap-1",children:[(0,a.jsxs)("button",{onClick:()=>t(W),className:`text-md flex flex-1 cursor-pointer items-center justify-center gap-1 border-2 border-amber-900 px-4 py-1 font-bold transition-colors ${e===W?"bg-amber-900 text-[#ffecb3]":"bg-transparent text-amber-900 hover:bg-amber-100"}`,children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),"Tasks"]}),(0,a.jsxs)("button",{onClick:()=>t(H),className:`text-md flex flex-1 cursor-pointer items-center justify-center gap-1 border-2 border-amber-900 px-4 py-1 font-bold transition-colors ${e===H?"bg-amber-900 text-[#ffecb3]":"bg-transparent text-amber-900 hover:bg-amber-100"}`,children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),"Music"]})]})}),!s&&(0,a.jsx)("div",{className:"my-4 border-t border-amber-900/20"}),(0,a.jsxs)("div",{className:`px-4 pb-4 ${s?"pt-4":"pt-0"}`,children:[(0,a.jsx)("div",{className:e===H?"block":"hidden",children:(0,a.jsx)(k,{isExpanded:s})}),(0,a.jsx)("div",{className:e===W?"block":"hidden",children:(0,a.jsx)(B,{isExpanded:s,lastRunTaskId:d,setLastRunTaskId:h})})]}),(0,a.jsx)("button",{onClick:()=>c(!s),"aria-label":s?"패널 접기":"패널 펼치기","aria-expanded":s,className:"flex w-full cursor-pointer items-center justify-center border-t-1 border-amber-900/30 bg-transparent py-2 text-amber-900 transition-colors hover:bg-amber-100",children:s?(0,a.jsx)(l.A,{className:"h-4 w-4"}):(0,a.jsx)(o.A,{className:"h-4 w-4"})})]})})}},2312:(e,t,s)=>{"use strict";s.d(t,{$:()=>a});let a=(0,s(7122).v)(e=>({contributions:{},setContributions:t=>e({contributions:t}),reset:()=>e({contributions:{}})}))},2393:(e,t,s)=>{"use strict";s.d(t,{C0:()=>i,ZG:()=>n,m9:()=>a,vk:()=>r});let a={COMMITTED:"COMMITTED",ISSUE_OPEN:"ISSUE_OPEN",PR_OPEN:"PR_OPEN",PR_REVIEWED:"PR_REVIEWED"},r={ALL:"ALL",FOCUSED:"FOCUSED",TASK_COMPLETED:"TASK_COMPLETED",ISSUE_OPEN:"ISSUE_OPEN",COMMITTED:"COMMITTED",PR_OPEN:"PR_OPEN",PR_MERGED:"PR_MERGED",PR_REVIEWED:"PR_REVIEWED"},i={[r.ALL]:"포인트",[r.ISSUE_OPEN]:"Issue 생성",[r.PR_OPEN]:"PR 생성",[r.PR_MERGED]:"PR 병합",[r.PR_REVIEWED]:"PR 리뷰",[r.COMMITTED]:"커밋",[r.TASK_COMPLETED]:"Task 완료",[r.FOCUSED]:"집중 시간"},n={[r.ALL]:"포인트 수집가",[r.ISSUE_OPEN]:"이슈 헌터",[r.PR_OPEN]:"PR 개척자",[r.PR_MERGED]:"PR 수확자",[r.PR_REVIEWED]:"PR 수호자",[r.COMMITTED]:"정원사",[r.TASK_COMPLETED]:"워커홀릭",[r.FOCUSED]:"마라토너"}},2463:(e,t,s)=>{"use strict";s.d(t,{M:()=>a});let a=(0,s(7122).v)((e,t)=>({progress:0,mapIndex:0,progressThreshold:200,addProgress:s=>{let a=t().progress,r=t().progressThreshold,i=Math.min(a+s,r);e({progress:i}),i>=r&&(t().onProgressComplete?.(),setTimeout(()=>{e({progress:0})},1e3))},setProgress:s=>{e({progress:Math.max(0,Math.min(t().progressThreshold,s))})},setMapIndex:t=>{e({mapIndex:Math.max(0,Math.min(t,4))})},setProgressThreshold:t=>{e({progressThreshold:t})},reset:()=>{e({progress:0})},getProgress:()=>t().progress,setOnProgressComplete:t=>{e({onProgressComplete:t})}}))},2654:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(546),r=s(7918),i=s(2983),n=s(7335);function l(){let{toggleModal:e}=(0,n.K)((0,i.k)(e=>({toggleModal:e.toggleModal})));return(0,a.jsx)("button",{id:"leaderboard-button",onClick:()=>e(n.e.LEADERBOARD),className:"flex h-12 w-12 cursor-pointer items-center justify-center border-3 border-amber-900 bg-[#ffecb3] shadow-[4px_4px_0px_0px_rgba(0,0,0,0.5)] transition-all hover:bg-amber-100 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none","aria-label":"순위표 열기",children:(0,a.jsx)(r.A,{className:"h-6 w-6 text-amber-900"})})}},3532:(e,t,s)=>{"use strict";s.d(t,{l:()=>r});var a=s(9393);let r={getPoints:(e,t)=>(0,a.Zq)(`/api/points?targetPlayerId=${e}&currentTime=${encodeURIComponent(t)}`),getGitEventHistories:(e,t,s)=>(0,a.Zq)(`/api/git-histories?targetPlayerId=${e}&startAt=${encodeURIComponent(t)}&endAt=${encodeURIComponent(s)}`),getRanks:e=>(0,a.Zq)(`/api/points/ranks?weekendStartAt=${encodeURIComponent(e)}`),getHistoryRanks:(e,t)=>(0,a.Zq)(`/api/history-ranks?weekendStartAt=${encodeURIComponent(e)}&type=${t}`)}},3738:(e,t,s)=>{"use strict";s.d(t,{d:()=>a});let a=(0,s(7122).v)(e=>({isDisconnected:!1,setDisconnected:t=>e({isDisconnected:t})}))},4071:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(546),r=s(842),i=s(7122);let n="onboarding_completed",l=(0,i.v)((e,t)=>({isActive:!1,currentStep:0,totalSteps:8,isShowingAction:!1,isChatOpen:!1,isWaitingForModalGuide:!1,modalSubStepIndex:-1,startOnboarding:()=>{e({isActive:!0,currentStep:0})},nextStep:()=>{let{currentStep:s,totalSteps:a,completeOnboarding:r}=t();s<a-1?e({currentStep:s+1,isShowingAction:!1,isChatOpen:!1,isWaitingForModalGuide:!1,modalSubStepIndex:-1}):r()},prevStep:()=>{let{currentStep:s}=t();s>0&&e({currentStep:s-1,isShowingAction:!1,isChatOpen:!1,isWaitingForModalGuide:!1,modalSubStepIndex:-1})},skipOnboarding:()=>{let{completeOnboarding:e}=t();e()},completeOnboarding:()=>{e({isActive:!1,currentStep:0,isShowingAction:!1,isChatOpen:!1,isWaitingForModalGuide:!1,modalSubStepIndex:-1}),localStorage.setItem(n,"true")},checkAndStartOnboarding:()=>{localStorage.getItem(n)||setTimeout(()=>{e({isActive:!0,currentStep:0})},1500)},setShowingAction:t=>{e({isShowingAction:t})},setChatOpen:t=>{e({isChatOpen:t})},setWaitingForModalGuide:t=>{e({isWaitingForModalGuide:t})},nextModalSubStep:()=>{let{modalSubStepIndex:s}=t();e({modalSubStepIndex:s+1})},resetModalSubStep:()=>{e({modalSubStepIndex:-1})}}));var o=s(7335);let c=[{id:"info",message:"안녕하세요. ' 잔디 심고 갈래? ' 에 오신 것을 환영합니다!<br>저는 간단한 서비스 사용 방법을 안내해 드릴 젠킨수예요. 함께 둘러볼까요?",highlight:null,triggerType:"manual"},{id:"move",message:"이곳은 여러분만의 공간이에요!<br>방향키(↑,↓,←,→) 또는 WASD 키로 캐릭터를 자유롭게 움직여 보세요!",highlight:null,triggerType:"keypress",triggerTarget:["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KeyW","KeyA","KeyS","KeyD"]},{id:"chat",message:"다른 동료들과 소통하고 싶으신가요?<br>엔터를 눌러 채팅창을 열고, 메시지를 입력한 뒤 다시 엔터를 눌러 보세요!",highlight:null,triggerType:"chat"},{id:"progress",message:"이 게이지는 우리 모두의 '열정'이에요! 여러분이 코딩에 집중하고 깃허브 활동을 할 때마다 게이지가 차오릅니다.<br>함께 힘을 모아 게이지를 채우면 무슨 일이 벌어질까요?!",highlight:"#progress-bar-container",triggerType:"manual"},{id:"leaderboard",message:"당신의 기여도는 몇 위인가요? 누가 가장 몰입했는지 확인해 보세요!<br>매주 새로운 시즌이 시작되니, 이번 주 '기여왕' 에 도전해 보는 건 어떨까요?",highlight:"#leaderboard-button",triggerType:"click",triggerTarget:"#leaderboard-button"},{id:"character",message:"나만의 프로필이 궁금하다면?<br>유저 정보 버튼이나 게임 속 캐릭터를 클릭해서 모달창을 열어 보세요!",highlight:"#user-info-button",triggerType:"modal-click",triggerTarget:"#user-info-button",afterModalHighlight:"#heatmap-info-link",afterModalMessage:"프로필 탭에서는 집중 이력을 확인할 수 있어요!<br>여기서 포인트 획득 정책도 확인할 수 있어요.",modalSubSteps:[{highlight:"#pet-tab-button",message:"이제 펫 탭을 클릭해서 귀여운 펫 친구들을 만나 보세요!",triggerType:"click",triggerTarget:"#pet-tab-button",delayAfterClick:2e3},{highlight:"#pet-gacha-button",message:"처음 오셨군요! 펫 뽑기 버튼을 눌러 첫 번째 펫 친구를 만나 보세요!",triggerType:"click",triggerTarget:"#pet-gacha-button",delayAfterClick:6e3,scrollIntoView:!0}]},{id:"pet",message:"축하해요! 첫 펫을 만났네요!<br>펫에게 먹이를 주며 성장시키고, 진화시킬 수 있어요. 도감에서 대표 펫도 변경할 수 있어요!",highlight:null,triggerType:"manual"},{id:"task",message:"마지막으로, 우측 상단의 작업 패널에서 타이머와 음악을 켤 수 있어요!<br>자, 이제 집중 모드를 시작해 볼까요? 화이팅!",highlight:"#focus-panel",triggerType:"manual"}];var d=s(8169);function h({message:e,currentStep:t,totalSteps:s,onNext:r,onPrev:i,onSkip:n,isFirstStep:l,isLastStep:o,isWaitingForTrigger:c,triggerHint:h}){return(0,a.jsx)("div",{className:"fixed right-0 bottom-0 left-0 z-[100] px-4 pb-4 md:px-8 lg:px-16",children:(0,a.jsxs)("div",{className:"relative mx-auto max-w-[1200px]",children:[(0,a.jsx)("div",{className:"absolute top-1/2 -left-4 z-10 -translate-y-1/2",children:(0,a.jsx)(d.default,{src:"/assets/mascot/tutorial_man1.png",alt:"튜토리얼 마스코트",width:300,height:300,className:"h-56 w-56 object-contain drop-shadow-lg",priority:!0})}),(0,a.jsxs)("div",{className:"relative flex min-h-[250px] flex-col rounded-lg border-4 border-amber-900 bg-gradient-to-b from-[#fff8e1] to-[#ffecb3] p-4 pl-44 shadow-[6px_6px_0px_0px_rgba(0,0,0,0.4)] md:p-5 md:pl-52 lg:p-6 lg:pl-60",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"rounded bg-amber-600 px-2 py-0.5 font-bold text-white",children:"젠킨수"}),(0,a.jsxs)("span",{className:"text-xs text-amber-600",children:["(",t+1,"/",s,")"]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"mb-4 text-base leading-relaxed font-medium text-amber-900 md:text-lg",children:e.split("<br>").map((e,t,s)=>(0,a.jsxs)("span",{children:[e,t<s.length-1&&(0,a.jsx)("br",{})]},t))}),c&&h&&(0,a.jsxs)("div",{className:"mb-3 animate-pulse rounded bg-amber-100 text-xl text-amber-700",children:["\uD83D\uDCA1 ",h]})]}),(0,a.jsxs)("div",{className:"mt-auto flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:n,className:"cursor-pointer text-sm text-amber-600 underline transition-colors hover:text-amber-800",children:"건너뛰기"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[!l&&(0,a.jsx)("button",{onClick:i,className:"cursor-pointer rounded border-3 border-amber-900 bg-amber-200 px-4 py-2 text-sm font-bold text-amber-900 shadow-[3px_3px_0px_0px_rgba(0,0,0,0.3)] transition-all hover:bg-amber-300 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none",children:"◀ 이전"}),!c&&(0,a.jsx)("button",{onClick:r,className:"cursor-pointer rounded border-3 border-amber-900 bg-amber-600 px-4 py-2 text-sm font-bold text-white shadow-[3px_3px_0px_0px_rgba(0,0,0,0.3)] transition-all hover:bg-amber-700 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none",children:o?"시작하기!":"다음 ▶"})]})]})]})]})})}function m({selector:e}){let[t,s]=(0,r.useState)(0),i=(0,r.useMemo)(()=>(function(e){if(!e)return null;let t=document.querySelector(e);if(!t)return null;let s=t.getBoundingClientRect();return{top:s.top,left:s.left,width:s.width,height:s.height}})(e),[e,t]);return((0,r.useLayoutEffect)(()=>{if(!e)return;let t=()=>{s(e=>e+1)};return window.addEventListener("resize",t),window.addEventListener("scroll",t,!0),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",t,!0)}},[e]),e)?i?(0,a.jsxs)("div",{className:"pointer-events-none fixed inset-0 z-[99]",children:[(0,a.jsx)("div",{className:"absolute bg-black/80",style:{top:0,left:0,right:0,height:Math.max(0,i.top-10)}}),(0,a.jsx)("div",{className:"absolute bg-black/80",style:{top:i.top+i.height+10,left:0,right:0,bottom:0}}),(0,a.jsx)("div",{className:"absolute bg-black/80",style:{top:Math.max(0,i.top-10),left:0,width:Math.max(0,i.left-10),height:i.height+20}}),(0,a.jsx)("div",{className:"absolute bg-black/80",style:{top:Math.max(0,i.top-10),left:i.left+i.width+10,right:0,height:i.height+20}}),(0,a.jsx)("div",{className:"absolute rounded-xl border-4 border-red-500",style:{top:i.top-10,left:i.left-10,width:i.width+20,height:i.height+20,boxShadow:"0 0 0 4px rgba(239, 68, 68, 0.3), 0 0 30px rgba(239, 68, 68, 0.5)",animation:"pulse 2s ease-in-out infinite"}}),(0,a.jsx)("div",{className:"absolute",style:{top:i.top+i.height+10+8,left:i.left+i.width/2-24},children:(0,a.jsx)("div",{className:"size-12 animate-bounce",children:(0,a.jsx)("img",{src:"/assets/arrow.png",alt:"arrow-up"})})})]}):(0,a.jsx)("div",{className:"pointer-events-none fixed inset-0 z-[99]",children:(0,a.jsx)("div",{className:"absolute inset-0 bg-black/80"})}):(0,a.jsxs)("div",{className:"pointer-events-none fixed inset-0 z-[99]",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/80"}),(0,a.jsx)("div",{className:"absolute right-0 bottom-0 left-0 h-64 bg-transparent",style:{pointerEvents:"none"}})]})}function u(){let{isActive:e,currentStep:t,totalSteps:s,nextStep:i,prevStep:n,skipOnboarding:d,checkAndStartOnboarding:u,isShowingAction:p,setShowingAction:x,isChatOpen:g,setChatOpen:b,isWaitingForModalGuide:f,setWaitingForModalGuide:v,modalSubStepIndex:y,nextModalSubStep:w}=l(),{closeModal:j}=(0,o.K)(),N=(0,r.useRef)(null);(0,r.useEffect)(()=>{u()},[u]),(0,r.useEffect)(()=>()=>{N.current&&clearTimeout(N.current)},[]);let S=c[t],k=f&&S?-1===y?{highlight:S.afterModalHighlight??null,message:S.afterModalMessage??S.message,triggerType:"manual",triggerTarget:void 0}:S.modalSubSteps&&y<S.modalSubSteps.length?S.modalSubSteps[y]:null:null,T=(0,r.useCallback)(()=>{f&&S.modalSubSteps&&y+1<S.modalSubSteps.length?w():("pet"===S.id&&j(),i())},[S,j,i,f,y,w]),_=(0,r.useCallback)(()=>{(f||"pet"===S.id||"character"===S.id)&&(j(),v(!1)),n()},[S,j,n,f,v]),I=(0,r.useCallback)(t=>{if(e&&S){if("keypress"===S.triggerType&&Array.isArray(S.triggerTarget)){if(S.triggerTarget.includes(t.code)){x(!0),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{i()},1e3);return}t.preventDefault(),t.stopPropagation();return}if("chat"===S.triggerType){if("Enter"===t.key)return void(g?(x(!1),b(!1),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{i()},500)):(b(!0),x(!0)));if(g)return}t.preventDefault(),t.stopPropagation()}},[e,S,i,x,g,b]),E=(0,r.useCallback)(t=>{if(!e||!S)return;let s=t.target,a=document.querySelector('[class*="fixed right-0 bottom-0 left-0 z-\\[100\\]"]');if(a&&a.contains(s)||s.closest('[class*="z-[110]"]'))return;let r=e=>{if(!e)return!1;let t=document.querySelector(e);return t&&(t===s||t.contains(s))};if(f&&k?.triggerType==="click"){if(r(k.triggerTarget)){x(!0),N.current&&clearTimeout(N.current);let e=y+1,t=S.modalSubSteps&&e<S.modalSubSteps.length;N.current=setTimeout(()=>{if(x(!1),t){let t=S.modalSubSteps[e];t.scrollIntoView&&t.triggerTarget&&setTimeout(()=>{let e=document.querySelector(t.triggerTarget);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100),w()}else v(!1),i()},k.delayAfterClick??500);return}t.preventDefault(),t.stopPropagation();return}if("click"===S.triggerType&&"string"==typeof S.triggerTarget){if(r(S.triggerTarget)){x(!0),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{j(),i()},2e3);return}t.preventDefault(),t.stopPropagation();return}if("modal-click"===S.triggerType&&"string"==typeof S.triggerTarget&&!f){if(r(S.triggerTarget)){x(!0),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{x(!1),v(!0)},500);return}t.preventDefault(),t.stopPropagation();return}t.preventDefault(),t.stopPropagation()},[e,S,i,x,j,f,v,k,y,w]);if((0,r.useEffect)(()=>{if(e)return window.addEventListener("keydown",I,!0),window.addEventListener("click",E,!0),()=>{window.removeEventListener("keydown",I,!0),window.removeEventListener("click",E,!0)}},[e,I,E]),!e||p)return null;let C=f&&k?k.highlight:S.highlight,M=f&&k?k.message:S.message;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{selector:C}),(0,a.jsx)(h,{message:M,currentStep:t,totalSteps:s,onNext:T,onPrev:_,onSkip:d,isFirstStep:0===t,isLastStep:t===s-1,isWaitingForTrigger:f&&k?"click"===k.triggerType:"manual"!==S.triggerType,triggerHint:(()=>{if(f&&k?.triggerType==="click")return"#pet-tab-button"===k.triggerTarget?"펫 탭을 클릭해보세요!":"#pet-gacha-button"===k.triggerTarget?"펫 뽑기 버튼을 클릭해보세요!":"해당 버튼을 클릭해보세요!";switch(S.triggerType){case"keypress":return"방향키 또는 WASD를 눌러보세요!";case"chat":return g?"메시지를 입력하고 엔터를 눌러 채팅창을 닫아보세요!":"엔터 키를 눌러 채팅창을 열어보세요!";case"click":return"해당 버튼을 클릭해보세요!";case"modal-click":return"유저 정보 버튼을 클릭해보세요!";default:return}})()})]})}},4189:(e,t,s)=>{"use strict";s.d(t,{X8:()=>c,gJ:()=>o,iZ:()=>l});var a=s(4816),r=s(8145),i=s(9141),n=s(807);function l(e,t){let s=(0,n.Zj)(t),{startAt:l,endAt:o}=(0,n.n1)(s),{data:c,isLoading:d,error:h,refetch:m}=(0,a.I)({queryKey:i.l.github.events(e,t),queryFn:()=>r.M.getEvents(e,l,o),enabled:e>0&&!!t,staleTime:0});return{events:c,isLoading:d,error:h,refetch:m}}function o(e){let{data:t,isLoading:s,error:n}=(0,a.I)({queryKey:i.l.github.user(e),queryFn:()=>r.M.getUser(e),enabled:!!e,staleTime:0});return{user:t,isLoading:s,error:n}}function c(e){let{data:t,isLoading:s,error:n}=(0,a.I)({queryKey:i.l.github.followStatus(e),queryFn:()=>r.M.getFollowStatus(e),enabled:!!e,staleTime:0});return{isFollowing:t?.isFollowing??!1,isLoading:s,error:n}}},4563:(e,t,s)=>{"use strict";s.d(t,{M:()=>n,O:()=>l});var a=s(7122),r=s(8986),i=s(807);let n={FOCUSING:"FOCUSING",RESTING:"RESTING"},l=(0,a.v)((e,t)=>({status:n.RESTING,isFocusTimerRunning:!1,error:null,baseFocusSeconds:0,serverCurrentSessionSeconds:0,serverReceivedAt:0,getFocusTime:()=>{let{status:e,baseFocusSeconds:s,serverCurrentSessionSeconds:a,serverReceivedAt:r}=t();return e===n.FOCUSING&&r>0?s+a+Math.max(0,Math.floor((Date.now()-r)/1e3)):s},setFocusTime:t=>e({baseFocusSeconds:t}),resetFocusTime:()=>e({baseFocusSeconds:0,serverCurrentSessionSeconds:0,serverReceivedAt:0}),setFocusTimerRunning:t=>e({isFocusTimerRunning:t}),clearError:()=>e({error:null}),startFocusing:(s,a)=>{let l=t(),o=void 0!==a;if(l.status===n.FOCUSING&&!o)return;let c=(0,r.Ol)();if(!c?.connected)return void e({error:"서버와 연결되지 않았습니다. 잠시 후 다시 시도해주세요."});let d=l.getFocusTime();e({status:n.FOCUSING,isFocusTimerRunning:!0,baseFocusSeconds:d,serverCurrentSessionSeconds:0,serverReceivedAt:Date.now(),error:null}),c.emit("focusing",{taskName:s,taskId:a,startAt:(0,i.DF)()},t=>{t?.success||e({status:l.status,isFocusTimerRunning:l.isFocusTimerRunning,baseFocusSeconds:l.baseFocusSeconds,serverCurrentSessionSeconds:l.serverCurrentSessionSeconds,serverReceivedAt:l.serverReceivedAt,error:t?.error||"집중 시작에 실패했습니다."})})},stopFocusing:()=>{let s=t();if(s.status===n.RESTING)return;let a=(0,r.Ol)();if(!a?.connected)return void e({error:"서버와 연결되지 않았습니다. 잠시 후 다시 시도해주세요."});let l=s.getFocusTime();e({status:n.RESTING,isFocusTimerRunning:!1,baseFocusSeconds:l,serverCurrentSessionSeconds:0,serverReceivedAt:0,error:null}),a.emit("resting",{startAt:(0,i.DF)()},t=>{t?.success||e({status:s.status,isFocusTimerRunning:s.isFocusTimerRunning,baseFocusSeconds:s.baseFocusSeconds,serverCurrentSessionSeconds:s.serverCurrentSessionSeconds,serverReceivedAt:s.serverReceivedAt,error:t?.error||"휴식 전환에 실패했습니다."})})},syncFromServer:t=>{let s=t.status===n.FOCUSING;e({status:t.status,isFocusTimerRunning:s,baseFocusSeconds:t.totalFocusSeconds,serverCurrentSessionSeconds:s?t.currentSessionSeconds:0,serverReceivedAt:s?Date.now():0,error:null})}}))},4902:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});let a={error:(...e)=>{},warn:(...e)=>{},info:(...e)=>{},log:(...e)=>{}}},5136:(e,t,s)=>{"use strict";s.d(t,{default:()=>y});var a=s(546),r=s(842),i=s(7335),n=s(6034),l=s(2983),o=s(1855),c=s(9976),d=s(6558),h=s(8986),m=s(9251),u=s(9147),p=s(4816),x=s(2619),g=s(9141),b=s(9393);let f=()=>(0,b.Zq)("/api/rooms"),v="border-3 border-amber-900";function y(){let{activeModal:e,closeModal:t}=(0,i.K)((0,l.k)(e=>({activeModal:e.activeModal,closeModal:e.closeModal}))),s=(0,m.K)(e=>e.roomId).split("-"),y=s.length>1?s[1]:"",w=e===i.e.CHANNEL_SELECT,{rooms:j,joinRoom:N,isLoading:S,refetch:k,isFetching:T}=(e=>{let t=(0,u.jE)(),{data:s={},isLoading:a,refetch:r,isFetching:i}=(0,p.I)({queryKey:g.l.rooms.all,queryFn:f,staleTime:0,enabled:e?.enabled});return{rooms:s,isLoading:a,joinRoom:(0,x.n)({mutationFn:e=>{let t;return t=e,(0,b.Zq)(`/api/rooms/${t}`,{method:"PATCH"})},onSuccess:()=>{t.invalidateQueries({queryKey:g.l.rooms.all})}}).mutateAsync,refetch:r,isFetching:i}})({enabled:w}),{contentRef:_,handleClose:I,handleBackdropClick:E}=(0,n.T)({isOpen:w,onClose:t}),[C,M]=(0,r.useState)(!1),P=async()=>{C||T||(M(!0),await Promise.all([k(),new Promise(e=>setTimeout(e,500))]),M(!1))},D=C||T,A=(0,r.useMemo)(()=>w&&j?Object.values(j).map(e=>{let t=parseInt(e.id.split("-")[1],10);return{id:t,roomId:e.id,name:`CH.${t}`,count:e.size,max:e.capacity}}).sort((e,t)=>e.id-t.id):[],[w,j]);if(!w)return null;let R=async e=>{try{await N(e.roomId),m.K.getState().setPendingRoomId(e.roomId),window.dispatchEvent(new CustomEvent("start_channel_transition",{detail:{onComplete:()=>{let e=(0,h.Ol)();e&&(e.disconnect(),e.connect())}}})),t()}catch(e){console.error("채널 이동 실패",e),"object"==typeof e&&null!==e&&"status"in e&&409===e.status?alert("채널이 가득 찼습니다."):alert("채널 이동에 실패했습니다."),P()}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-10",onClick:E,children:(0,a.jsxs)("div",{ref:_,role:"dialog","aria-modal":"true","aria-labelledby":"channel-select-title",className:`relative w-full max-w-lg bg-[#ffecb3] ${v} p-4 shadow-[8px_8px_0px_0px_rgba(0,0,0,0.5)]`,children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h2",{id:"channel-select-title",className:"text-xl font-extrabold tracking-wider text-amber-900",children:"채널 선택"}),(0,a.jsx)("button",{onClick:P,disabled:D,"aria-label":"채널 목록 새로고침",className:"flex h-8 w-8 cursor-pointer items-center justify-center text-amber-900 disabled:cursor-not-allowed disabled:opacity-50",children:(0,a.jsx)(o.A,{className:`h-5 w-5 ${D?"animate-spin":""}`})})]}),(0,a.jsx)("button",{onClick:I,"aria-label":"채널 선택 모달 닫기",className:`flex h-8 w-8 cursor-pointer items-center justify-center ${v} bg-red-400 leading-none font-bold text-white shadow-[2px_2px_0px_0px_rgba(30,30,30,0.3)] hover:bg-red-500 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none`,children:"X"})]}),(0,a.jsxs)("div",{className:`${v} relative overflow-hidden bg-white/50 p-3`,children:[(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 opacity-5"}),(0,a.jsx)("div",{className:"space-y-3 p-1",children:A.map(e=>{let t=e.count>=e.max,s=y===e.id.toString();return(0,a.jsxs)("div",{className:`flex items-center justify-between p-3 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.1)] transition-transform hover:scale-[1.01] ${s?"border-3 border-green-600 bg-green-50":`${v} bg-white`}`,children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-lg font-bold tracking-wide text-amber-900",children:[e.name,s&&(0,a.jsx)("span",{className:"ml-2 rounded border border-green-600 px-1 text-xs text-green-600",children:"YOU"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-amber-700",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:t?"font-bold text-red-500":"",children:[e.count," / ",e.max]})]})]}),(0,a.jsxs)("button",{onClick:()=>!t&&!s&&R(e),disabled:t||s,className:`flex w-24 items-center justify-center gap-2 px-4 py-2 text-white transition-all ${s?"cursor-default bg-green-600 shadow-[inset_-4px_-4px_0px_0px_#15803d,inset_4px_4px_0px_0px_#86efac]":t?"cursor-not-allowed bg-zinc-500 shadow-[inset_-4px_-4px_0px_0px_#555,inset_4px_4px_0px_0px_#aaa]":"cursor-pointer bg-amber-500 shadow-[inset_-4px_-4px_0px_0px_#b45309,inset_4px_4px_0px_0px_#fcd34d] hover:bg-amber-400 active:shadow-[inset_4px_4px_0px_0px_#b45309]"}`,children:[(0,a.jsx)("span",{className:"font-bold tracking-wider",children:s?"참여중":t?"FULL":"입장"}),!t&&!s&&(0,a.jsx)(d.A,{className:"h-4 w-4"})]})]},e.id)})})]})]})})}},5349:(e,t,s)=>{"use strict";function a(e){return{id:e.id,description:e.description,completed:e.isCompleted,time:e.totalFocusSeconds,baseTime:e.totalFocusSeconds,startTimestamp:null,isRunning:!1,createdAt:e.createdAt}}s.d(t,{Y:()=>a})},5694:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(546),r=s(2983),i=s(7335),n=s(9251);function l(){let{toggleModal:e}=(0,i.K)((0,r.k)(e=>({toggleModal:e.toggleModal}))),t=(0,n.K)(e=>e.roomId).split("-")[1];return(0,a.jsx)("button",{id:"channel-select-button",onClick:()=>e(i.e.CHANNEL_SELECT),className:"flex h-12 w-12 cursor-pointer items-center justify-center font-bold border-3 border-amber-900 bg-[#ffecb3] shadow-[4px_4px_0px_0px_rgba(0,0,0,0.5)] transition-all hover:bg-amber-100 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none","aria-label":"채널 선택",children:(0,a.jsx)("span",{className:"tracking-wider text-amber-900",children:t?`CH.${t}`:"CH"})})}},5963:(e,t,s)=>{"use strict";s.d(t,{d:()=>u});var a=s(7122),r=s(8790),i=s(4902),n=s(4563),l=s(8986),o=s(9873),c=s(807);let d={TASK_FOCUSING:"집중 중인 태스크는 삭제할 수 없습니다.",TASK_NOT_FOUND:"태스크를 찾을 수 없습니다.",TASK_NOT_OWNED:"본인의 태스크만 삭제할 수 있습니다."};function h(e,t="알 수 없는 오류가 발생했습니다."){return e&&e in d?d[e]:t}var m=s(5349);let u=(0,a.v)((e,t)=>{let s=e=>t().pendingTaskIds.includes(e),a=t=>e(e=>({pendingTaskIds:e.pendingTaskIds.includes(t)?e.pendingTaskIds:[...e.pendingTaskIds,t]})),d=t=>e(e=>({pendingTaskIds:e.pendingTaskIds.filter(e=>e!==t)}));return{tasks:[],isLoading:!1,error:null,pendingTaskIds:[],clearError:()=>e({error:null}),fetchTasks:async t=>{let{user:s,isLoading:a}=o.n.getState();if(a)return;let n=s?.playerId;if(!n)return void e({tasks:[],pendingTaskIds:[],error:"로그인이 필요합니다.",isLoading:!1});let l=t?(0,c.Zj)(t):new Date,{startAt:d,endAt:h}=(0,c.n1)(l),u=(0,c.HN)(l)===(0,c.HN)(new Date);e({isLoading:!0,error:null});try{let t=(await r.WY.getTasks(n,u,d,h)).tasks.map(m.Y);e({tasks:t,isLoading:!1})}catch(s){i.K.error("Failed to fetch tasks",{date:t,error:s}),e({error:"Task 목록을 불러오는데 실패했습니다.",isLoading:!1})}},addTask:async t=>{let s=t.trim();if(!s)return void e({error:"Task 내용을 입력해주세요."});if(s.length>100)return void e({error:"Task는 100자 이하로 입력해주세요."});try{let t=await r.WY.createTask(s),a=(0,m.Y)(t);e(e=>({tasks:[...e.tasks,a],error:null}))}catch(t){i.K.error("Failed to create task",{error:t}),e({error:"Task 생성에 실패했습니다."})}},toggleTask:async n=>{if(s(n))return;let{tasks:l}=t(),o=l.find(e=>e.id===n);if(o){e({error:null}),a(n),e(e=>({tasks:e.tasks.map(e=>e.id===n?{...e,completed:!e.completed}:e)}));try{o.completed?await r.WY.uncompleteTask(n):await r.WY.completeTask(n)}catch(t){i.K.error("Failed to toggle task",{id:n,error:t}),e(e=>({tasks:e.tasks.map(e=>e.id===n?{...e,completed:o.completed}:e),error:"Task 상태 변경에 실패했습니다."}))}finally{d(n)}}},deleteTask:async n=>{if(s(n))return;let{tasks:l}=t(),o=l.findIndex(e=>e.id===n),c=o>=0?l[o]:void 0;if(c){if(c.isRunning)return void e({error:h("TASK_FOCUSING")});e({error:null}),a(n),e(e=>({tasks:e.tasks.filter(e=>e.id!==n)}));try{await r.WY.deleteTask(n)}catch(s){i.K.error("Failed to delete task",{id:n,error:s});let t=h(s instanceof r.hD?s.code:void 0,"Task 삭제에 실패했습니다.");e(e=>({tasks:[...e.tasks.slice(0,o),c,...e.tasks.slice(o)],error:t}))}finally{d(n)}}},editTask:async(o,c)=>{let h=c.trim();if(!h)return void e({error:"Task 내용을 입력해주세요."});if(h.length>100)return void e({error:"Task는 100자 이하로 입력해주세요."});if(s(o))return;let{tasks:m}=t(),u=m.find(e=>e.id===o);if(!u)return;e({error:null}),a(o);let p=u.description;e(e=>({tasks:e.tasks.map(e=>e.id===o?{...e,description:h}:e)}));try{if(await r.WY.updateTask(o,h),u.isRunning){let{status:e}=n.O.getState();if(e===n.M.FOCUSING){let e=(0,l.Ol)();e?.connected&&e.emit("focus_task_updating",{taskName:h})}}}catch(t){i.K.error("Failed to update task",{id:o,error:t}),e(e=>({tasks:e.tasks.map(e=>e.id===o?{...e,description:p}:e),error:"Task 수정에 실패했습니다."}))}finally{d(o)}},getTaskDisplayTime:e=>e.isRunning&&e.startTimestamp?e.baseTime+Math.floor((Date.now()-e.startTimestamp)/1e3):e.time,toggleTaskTimer:s=>{let{tasks:a}=t();a.find(e=>e.id===s)&&e(e=>({tasks:e.tasks.map(e=>{if(e.id===s)if(!e.isRunning)return{...e,isRunning:!0,baseTime:e.time,startTimestamp:Date.now()};else{let t=e.startTimestamp?Math.floor((Date.now()-e.startTimestamp)/1e3):0,s=e.baseTime+t;return{...e,isRunning:!1,time:s,baseTime:s,startTimestamp:null}}if(e.isRunning&&e.startTimestamp){let t=Math.floor((Date.now()-e.startTimestamp)/1e3),s=e.baseTime+t;return{...e,isRunning:!1,time:s,baseTime:s,startTimestamp:null}}return e})}))},stopAllTasks:()=>e(e=>({tasks:e.tasks.map(e=>{if(e.isRunning&&e.startTimestamp){let t=Math.floor((Date.now()-e.startTimestamp)/1e3),s=e.baseTime+t;return{...e,isRunning:!1,time:s,baseTime:s,startTimestamp:null}}return{...e,isRunning:!1}})})),removeCompletedTasks:()=>e(e=>({tasks:e.tasks.filter(e=>!e.completed)}))}})},6034:(e,t,s)=>{"use strict";s.d(t,{T:()=>r});var a=s(842);function r({isOpen:e,onClose:t}){let s=(0,a.useRef)(null),r=(0,a.useRef)(t);(0,a.useEffect)(()=>{r.current=t},[t]);let i=(0,a.useCallback)(()=>{r.current()},[]);(0,a.useEffect)(()=>{if(!e)return;let t=e=>{"Escape"===e.key&&i()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,i]);let n=(0,a.useCallback)(e=>{s.current&&!s.current.contains(e.target)&&i()},[i]);return{contentRef:s,handleClose:i,handleBackdropClick:n}}},6375:(e,t,s)=>{"use strict";s.d(t,{Q:()=>r});var a=s(9393);let r={getFocusTime:(e,t,s)=>(0,a.Zq)(`/api/focustime/${e}?startAt=${encodeURIComponent(t)}&endAt=${encodeURIComponent(s)}`)}},7335:(e,t,s)=>{"use strict";s.d(t,{K:()=>i,e:()=>r});var a=s(7122);let r={USER_INFO:"userInfo",LEADERBOARD:"leaderboard",CHANNEL_SELECT:"channelSelect"},i=(0,a.v)((e,t)=>({activeModal:null,userInfoPayload:null,openModal:(t,s)=>{t!==r.USER_INFO||s?e({activeModal:t,userInfoPayload:s||null}):console.warn("UserInfo modal requires payload")},closeModal:()=>e({activeModal:null,userInfoPayload:null}),toggleModal:(s,a)=>{let{activeModal:i}=t();if(i===s)e({activeModal:null,userInfoPayload:null});else{if(s===r.USER_INFO&&!a)return void console.warn("UserInfo modal requires payload");e({activeModal:s,userInfoPayload:s===r.USER_INFO?a:null})}}}))},7337:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var a=s(546),r=s(3738);function i(){return(0,r.d)(e=>e.isDisconnected)?(0,a.jsxs)("div",{className:"fixed inset-0 z-[110] flex flex-col items-center justify-center bg-black/70",children:[(0,a.jsx)("p",{className:"mb-4 text-2xl text-white",children:"서버와의 연결이 끊어졌습니다."}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"rounded-lg border-2 border-green-400 px-6 py-2 text-lg text-green-400 hover:bg-green-400/10 focus-visible:ring-2 focus-visible:ring-green-400 focus-visible:ring-offset-2 focus-visible:ring-offset-black focus-visible:outline-none",children:"새로고침"})]}):null}},8087:(e,t,s)=>{"use strict";s.d(t,{W:()=>r});var a=s(9393);let r={getTasks:(e,t,s,r)=>(0,a.Zq)(`/api/tasks/${e}?isToday=${t}${s&&r?`&startAt=${encodeURIComponent(s)}&endAt=${encodeURIComponent(r)}`:""}`),createTask:e=>(0,a.Zq)("/api/tasks",{method:"POST",body:JSON.stringify({description:e})}),updateTask:(e,t)=>(0,a.Zq)(`/api/tasks/${e}`,{method:"PATCH",body:JSON.stringify({description:t})}),completeTask:e=>(0,a.Zq)(`/api/tasks/completion/${e}`,{method:"PATCH"}),uncompleteTask:e=>(0,a.Zq)(`/api/tasks/uncompletion/${e}`,{method:"PATCH"}),deleteTask:e=>(0,a.Zq)(`/api/tasks/${e}`,{method:"DELETE"})}},8143:(e,t,s)=>{"use strict";s.d(t,{g:()=>r});var a=s(9393);let r={getInventory:e=>(0,a.Zq)(`/api/pets/inventory/${e}`),gacha:()=>(0,a.Zq)("/api/pets/gacha",{method:"POST"}),gachaRefund:()=>(0,a.Zq)("/api/pets/gacha/refund",{method:"POST"}),feed:e=>(0,a.Zq)("/api/pets/feed",{method:"POST",body:JSON.stringify({userPetId:e})}),evolve:e=>(0,a.Zq)("/api/pets/evolve",{method:"POST",body:JSON.stringify({userPetId:e})}),equipPet:e=>(0,a.Zq)("/api/players/me/equipped-pet",{method:"PATCH",body:JSON.stringify({petId:e})}),getCodex:e=>(0,a.Zq)(`/api/pets/codex/${e}`),getAllPets:()=>(0,a.Zq)("/api/pets/all"),getPlayer:e=>(0,a.Zq)(`/api/players/${e}/info`)}},8145:(e,t,s)=>{"use strict";s.d(t,{M:()=>r});var a=s(9393);let r={getEvents:(e,t,s)=>(0,a.Zq)(`/api/github/events?playerId=${e}&startAt=${encodeURIComponent(t)}&endAt=${encodeURIComponent(s)}`),getUser:e=>(0,a.Zq)(`/api/github/users/${e}`),getFollowStatus:e=>(0,a.Zq)(`/api/github/users/${e}/follow-status`),followUser:e=>(0,a.Zq)(`/api/github/users/${e}/follow`,{method:"PUT"}),unfollowUser:e=>(0,a.Zq)(`/api/github/users/${e}/follow`,{method:"DELETE"})}},8450:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(546),r=s(2922),i=s(842),n=s(9873);function l({children:e}){let t=(0,r.useRouter)(),{isAuthenticated:s,isLoading:l,fetchUser:o}=(0,n.n)();return((0,i.useEffect)(()=>{o()},[o]),(0,i.useEffect)(()=>{l||s||t.replace("/login")},[l,s,t]),l)?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-4 h-12 w-12 animate-spin rounded-full border-4 border-gray-600 border-t-white"}),(0,a.jsx)("p",{className:"text-white",children:"로딩 중..."})]})}):s?(0,a.jsx)(a.Fragment,{children:e}):null}},8601:(e,t,s)=>{"use strict";s.d(t,{$:()=>r});var a=s(546);function r({className:e="",children:t,...s}){return(0,a.jsx)("button",{className:e,...s,children:t})}s(842)},8702:(e,t,s)=>{"use strict";s.d(t,{default:()=>P});var a=s(546),r=s(842),i=s(6346),n=s(4816),l=s(8143),o=s(8986),c=s(807),d=s(7335);let h="stop";class m{constructor(e,t){this.sprite=null,this.currentDirection=h,this.offset={x:35,y:0},this.isDestroyed=!1,this.PET_SIZE=50,this.DISTANCE_X=40,this.DISTANCE_Y=50,this.BODY_CENTER_Y=5,this.scene=e,this.container=t}setTexture(e){if(!this.isDestroyed&&this.container?.scene&&this.container.active&&this.scene?.textures?.exists(e))if(this.sprite){if(!this.sprite?.scene)return;this.sprite.setTexture(e),this.setSpriteScale()}else{if(!this.scene?.add)return;this.sprite=this.scene.add.image(this.offset.x,this.offset.y,e),this.setSpriteScale(),this.sprite.setOrigin(.5,.5),this.container.add(this.sprite),this.container.sendToBack(this.sprite)}}setSpriteScale(){if(!this.sprite)return;let e=this.sprite.width,t=this.sprite.height,s=this.PET_SIZE/Math.max(e,t);this.sprite.setScale(s)}getSprite(){return this.sprite}updatePosition(e){if(!this.sprite||e===this.currentDirection)return;this.currentDirection=e;let t=0,s=this.BODY_CENTER_Y+this.DISTANCE_Y;switch(e){case"left":t=this.DISTANCE_X,s=this.BODY_CENTER_Y;break;case"right":t=-this.DISTANCE_X,s=this.BODY_CENTER_Y;break;case"up":t=0,s=this.BODY_CENTER_Y+this.DISTANCE_Y;break;case"down":t=0,s=this.BODY_CENTER_Y-this.DISTANCE_Y;break;case"left-up":t=this.DISTANCE_X,s=this.BODY_CENTER_Y+this.DISTANCE_X;break;case"left-down":t=this.DISTANCE_X,s=this.BODY_CENTER_Y-this.DISTANCE_X;break;case"right-up":t=-this.DISTANCE_X,s=this.BODY_CENTER_Y+this.DISTANCE_X;break;case"right-down":t=-this.DISTANCE_X,s=this.BODY_CENTER_Y-this.DISTANCE_X;break;default:return}this.scene.tweens.add({targets:this.sprite,x:t,y:s,duration:150,ease:"Power2"}),this.offset={x:t,y:s}}clear(){this.sprite&&(this.sprite.destroy(),this.sprite=null)}destroy(){this.isDestroyed=!0,this.clear()}}class u{constructor(e,t,s,a,r,n="face",l=0){this.bodyGlow=null,this.taskBubbleContainer=null,this.playerId=0,this.speed=300,this.isDestroyed=!1,this.pendingLoaderListeners=[],this.currentPetLoadVersion=0,this.petLoadingKeys=new Set,this.scene=e,this.id=r,this.username=a,this.playerId=l,this.container=e.add.container(t,s),this.bodySprite=e.add.sprite(0,5,"body"),this.bodySprite.setFrame(0),this.maskShape=e.make.graphics({}),this.maskShape.fillStyle(0xffffff),this.maskShape.fillCircle(0,0,17),this.maskShape.x=t,this.maskShape.y=s;const o=this.maskShape.createGeometryMask(),h=e.textures.exists(n)?n:"face";this.faceSprite=e.add.image(0,0,h),this.faceSprite.setDisplaySize(34,34),this.faceSprite.setMask(o),this.borderGraphics=e.add.graphics(),this.borderGraphics.lineStyle(2,0xffffff,1),this.borderGraphics.strokeCircle(0,0,17);const u=e.add.text(0,50,a,{fontFamily:"NeoDunggeunmo, Arial, sans-serif",fontSize:"15px",color:"#ffffff",backgroundColor:"#00000088",padding:{x:4,y:2}}).setOrigin(.5).setResolution(2);this.focusTimeText=e.add.text(0,66,(0,c.FT)(0),{fontFamily:"NeoDunggeunmo, Arial, sans-serif",fontSize:"13px",color:"#ffffff",backgroundColor:"#00000088",padding:{x:4,y:.5}}).setOrigin(.5).setResolution(2),this.pet=new m(e,this.container),this.shadowGraphics=e.add.graphics(),this.shadowGraphics.fillStyle(0,.3),this.shadowGraphics.fillEllipse(0,32,32,10);const p=[this.shadowGraphics,this.bodySprite,this.faceSprite,this.borderGraphics,u,this.focusTimeText];this.container.add(p),this.container.setSize(34,51),e.physics.world.enable(this.container),this.body=this.container.body,this.body.setCollideWorldBounds(!0),this.body.setSize(34,8.5),this.body.setOffset(0,50),this.container.setInteractive(new i.Geom.Rectangle(0,10,34,51),i.Geom.Rectangle.Contains),this.bodySprite.preFX&&(this.bodyGlow=this.bodySprite.preFX.addGlow(0xffff00,4,0,!1),this.bodyGlow.active=!1),this.container.on("pointerdown",(e,t,s,a)=>{let r,i,n=e.event;(n instanceof TouchEvent?(r=n.touches[0]?.clientX??0,i=n.touches[0]?.clientY??0):(r=n.clientX,i=n.clientY),document.elementFromPoint(r,i)!==this.scene.game.canvas)?a.stopPropagation():d.K.getState().openModal(d.e.USER_INFO,{playerId:this.playerId,username:this.username})}),this.container.on("pointerover",()=>{this.scene.game.canvas.style.cursor="pointer",this.borderGraphics.clear(),this.borderGraphics.lineStyle(3,0xffff00,1),this.borderGraphics.strokeCircle(0,0,17),this.bodyGlow&&(this.bodyGlow.active=!0)}),this.container.on("pointerout",()=>{this.scene.game.canvas.style.cursor="default",this.borderGraphics.clear(),this.borderGraphics.lineStyle(2,0xffffff,1),this.borderGraphics.strokeCircle(0,0,17),this.bodyGlow&&(this.bodyGlow.active=!1)})}update(){this.container&&this.maskShape&&(this.maskShape.x=this.container.x,this.maskShape.y=this.container.y,this.container.setDepth(Math.max(0,this.container.y)))}updatePetPosition(e){this.pet.updatePosition(e)}updateFocusTime(e){this.focusTimeText&&this.focusTimeText.setText((0,c.FT)(e))}getPosition(){return{x:this.container.x,y:this.container.y}}getContainer(){return this.container}setPosition(e,t){this.container.setPosition(e,t),this.body&&this.body.reset(e,t)}destroy(){this.isDestroyed=!0,this.scene?.load&&this.pendingLoaderListeners.forEach(({event:e,callback:t})=>{this.scene.load.off(e,t)}),this.pendingLoaderListeners=[],this.petLoadingKeys.clear(),this.musicParticleEmitter?.destroy(),this.pet.destroy(),this.container.destroy(),this.maskShape.destroy()}updateFaceTexture(e){!this.isDestroyed&&this.faceSprite?.scene&&this.scene.textures.exists(e)&&(this.faceSprite.setTexture(e),this.faceSprite.setDisplaySize(34,34))}playAnimation(e,t=!0){this.bodySprite&&this.bodySprite.play(e,t)}stopAnimation(){this.bodySprite&&this.bodySprite.stop()}setPet(e){if(this.isDestroyed)return;this.currentPetLoadVersion++;let t=this.currentPetLoadVersion;if(!e)return void this.pet.clear();let s=`pet_${this.hashString(e)}`;if(this.scene.textures.exists(s))return void this.pet.setTexture(s);let a=this.petLoadingKeys.has(s),r=()=>{this.petLoadingKeys.delete(s),this.cleanupListener("loaderror",i),this.cleanupListener(`filecomplete-image-${s}`,n)},i=e=>{e?.key===s&&(console.error(`[BasePlayer] Load error for ${s}:`,e),r())},n=()=>{r(),this.isDestroyed||t!==this.currentPetLoadVersion||this.pet.setTexture(s)};this.registerListener("loaderror",i),this.registerListener(`filecomplete-image-${s}`,n),this.scene.load.on("loaderror",i),this.scene.load.once(`filecomplete-image-${s}`,n),!a&&(this.petLoadingKeys.add(s),this.scene.load.image(s,e),this.scene.load.isLoading()||this.scene.load.start())}hashString(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return Math.abs(t).toString(36)}registerListener(e,t){this.pendingLoaderListeners.push({event:e,callback:t})}cleanupListener(e,t){this.scene?.load&&this.scene.load.off(e,t),this.pendingLoaderListeners=this.pendingLoaderListeners.filter(s=>s.event!==e||s.callback!==t)}updateTaskBubble(e){this.taskBubbleContainer&&(this.taskBubbleContainer.destroy(),this.taskBubbleContainer=null);let{isFocusing:t,taskName:s}=e;this.taskBubbleContainer=this.scene.add.container(0,-40),this.taskBubbleContainer.setName("taskBubble");let a=t?"작업 중":"휴식 중";t&&s&&(a=s.length>15?s.slice(0,15)+"...":s);let r=[],i=this.scene.add.graphics();i.fillStyle(t?2278750:0xef4444,1);let n=this.scene.add.text(0,0,a,{fontFamily:"NeoDunggeunmo, Arial, sans-serif",fontSize:"13px",color:t?"#166534":"#991b1b"});n.setResolution(2),n.setOrigin(0,.5),r.push(i,n);let l=11+n.width+16,o=this.scene.add.graphics();o.fillStyle(t?0xdcfce7:0xfee2e2,1),o.lineStyle(1,t?8843180:0xfca5a5,1),o.fillRoundedRect(-l/2,-12,l,24,12),o.strokeRoundedRect(-l/2,-12,l,24,12),i.fillCircle(-l/2+8+2.5,0,2.5),n.setPosition(-l/2+8+5+6,0),this.taskBubbleContainer.add([o,...r]),this.container.add(this.taskBubbleContainer),this.container.bringToTop(this.taskBubbleContainer)}showChatBubble(e){let t=this.container.getByName("chatBubble");t&&t.destroy();let s=40*!!this.taskBubbleContainer,a=this.scene.add.container(0,-20-s);a.setName("chatBubble");let r=this.scene.add.text(0,-14,e,{fontFamily:"NeoDunggeunmo, Arial, sans-serif",fontSize:"14px",color:"#000000",wordWrap:{width:150,useAdvancedWrap:!0}});r.setResolution(2),r.setOrigin(.5,1);let i=r.getBounds(),n=i.width+16,l=i.height+16,o=-n/2,c=-6-l,d=this.scene.add.graphics();d.fillStyle(0,.02),d.fillRoundedRect(o+5,c+5,n,l,10),d.fillStyle(0,.04),d.fillRoundedRect(o+3,c+4,n,l,10),d.fillStyle(0,.08),d.fillRoundedRect(o+1,c+2,n,l,10),d.fillStyle(0xffffff,1),d.lineStyle(1,0xd1d5db,1),d.fillRoundedRect(o,c,n,l,10),d.strokeRoundedRect(o,c,n,l,10),d.fillStyle(0xffffff,1),d.fillTriangle(-4,-6,4,-6,0,0),d.lineStyle(1.5,0xe5e7eb,1),d.beginPath(),d.moveTo(-4,-6),d.lineTo(0,0),d.lineTo(4,-6),d.strokePath(),d.lineStyle(2,0xffffff,1),d.lineBetween(-3,-6,3,-6),a.add([d,r]),this.container.add(a),this.scene.time.delayedCall(5e3,()=>{a.active&&a.destroy()}),this.container.bringToTop(a),this.taskBubbleContainer&&this.container.bringToTop(this.taskBubbleContainer)}setMusicStatus(e){e?(this.musicParticleEmitter||(this.scene.textures.exists("music_notes_atlas")?(this.musicParticleEmitter=this.scene.add.particles(0,0,"music_notes_atlas",{frame:[0,1,2,3],speed:{min:20,max:50},angle:{min:290,max:340},scale:{start:.8,end:.8},alpha:{start:1,end:0},lifespan:1500,frequency:500,quantity:1,follow:this.container,followOffset:{x:20,y:0}}),this.musicParticleEmitter.setDepth(this.container.depth+1)):console.warn("[BasePlayer] music_notes_atlas texture not found")),this.musicParticleEmitter?.start()):this.musicParticleEmitter?.stop()}}class p extends u{constructor(e,t,s,a,r,i,n=0){super(e,t,s,a,r,a,n),this.prevState={isMoving:!1,direction:h},this.roomId=i}setRoomId(e){this.roomId=e}update(e,t){if(super.update(),!this.body||!e)return;let s=0,a=0,r="",i="";e.left.isDown||t?.A.isDown?(s=-this.speed,r="left"):(e.right.isDown||t?.D.isDown)&&(s=this.speed,r="right"),e.up.isDown||t?.W.isDown?(a=-this.speed,i="up"):(e.down.isDown||t?.S.isDown)&&(a=this.speed,i="down"),this.body.setVelocity(s,a);let n=0!==s||0!==a;if(n){let e=this.body.blocked;"left"===r&&e.left&&(n=!1),"right"===r&&e.right&&(n=!1),"up"===i&&e.up&&(n=!1),"down"===i&&e.down&&(n=!1)}let l=h;if(n&&(r&&i?l=`${r}-${i}`:r?l=r:i&&(l=i)),n?"left"===r?this.playAnimation("walk-left"):"right"===r?this.playAnimation("walk-right"):"up"===i?this.playAnimation("walk-up"):"down"===i&&this.playAnimation("walk-down"):this.stopAnimation(),n!==this.prevState.isMoving||l!==this.prevState.direction){let e={roomId:this.roomId,userId:this.id,x:this.container.x,y:this.container.y,isMoving:n,direction:l,timestamp:Date.now()};(0,o.c)("moving",e),this.updatePetPosition(l),this.prevState={isMoving:n,direction:l}}}}var x=s(4563),g=s(5963);class b{constructor(e,t){this.currentMapIndex=0,this.tileSize=32,this.worldScale=4,this.scene=e,this.maps=t}loadAndSetup(e,t){this.currentMapIndex=e;let s=this.maps[e];if(this.scene.textures.exists(s.image)){this.setup(),t();return}this.scene.load.image(s.image,s.imagePath),this.scene.load.once("complete",()=>{this.setup(),t()}),this.scene.load.start()}setup(){let e=this.maps[this.currentMapIndex],t=this.scene.add.image(0,0,e.image);t.setOrigin(0,0),t.setName("mapImage"),t.setDepth(-1);let s=t.width/this.worldScale,a=t.height/this.worldScale;if(t.setScale(1/this.worldScale),this.scene.physics.world.setBounds(0,0,s,a),this.walls=this.scene.physics.add.staticGroup(),e.tilemap){let t=this.scene.make.tilemap({key:e.tilemap}).getObjectLayer("Collisions");t&&t.objects.forEach(e=>{if(("class"in e&&"wall"===e.class||"wall"===e.type)&&void 0!==e.x&&void 0!==e.y){let t=this.scene.add.rectangle((e.x+(e.width||0)/2)/this.worldScale,(e.y+(e.height||0)/2)/this.worldScale,(e.width||0)/this.worldScale,(e.height||0)/this.worldScale,0xff0000,0);t.setVisible(!1),this.walls?.add(t)}})}}getMapImage(){return this.scene.children.getByName("mapImage")}getWalls(){return this.walls}getMapSize(){let e=this.getMapImage();return e?{width:e.width/this.worldScale,height:e.height/this.worldScale}:{width:0,height:0}}getWorldScale(){return this.worldScale}getTileSize(){return this.tileSize}switchToMap(e,t){e!==this.currentMapIndex&&(this.scene.cameras.main.fadeOut(500,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",()=>{let s=this.scene.children.getByName("mapImage");s&&s.destroy(),this.walls?.clear(!0,!0),this.loadAndSetup(e,()=>{t(),this.scene.cameras.main.fadeIn(500,0,0,0)})}))}getCurrentMapIndex(){return this.currentMapIndex}destroy(){this.walls?.clear(!0,!0);let e=this.getMapImage();e&&e.destroy()}getRandomSpawnPosition(){let{width:e,height:t}=this.getMapSize(),s=e/2,a=t/2,r=.2*e,i=.2*t,n=this.getWallRects();for(let e=0;e<10;e++){let e=s+(Math.random()-.5)*r,t=a+(Math.random()-.5)*i;if(!n.some(s=>this.rectIntersects(e-16,t-16,32,32,s.x,s.y,s.width,s.height)))return{x:Math.round(e),y:Math.round(t)}}return console.warn("Failed to find valid spawn position, using center"),{x:Math.round(s),y:Math.round(a)}}getWallRects(){let e=[];return this.walls&&this.walls.getChildren().forEach(t=>{e.push({x:t.x-t.width/2,y:t.y-t.height/2,width:t.width,height:t.height})}),e}rectIntersects(e,t,s,a,r,i,n,l){return e<r+n&&e+s>r&&t<i+l&&t+a>i}}var f=s(4902);class v extends u{constructor(e,t,s,a,r,i,n=0){super(e,t,s,a,r,i,n),this.isFocusing=!1,this.baseFocusSeconds=0,this.serverCurrentSessionSeconds=0,this.serverReceivedAt=0}setFocusState(e,t){this.isFocusing=e,this.baseFocusSeconds=t?.totalFocusSeconds??0,e?(this.serverCurrentSessionSeconds=t?.currentSessionSeconds??0,this.serverReceivedAt=Date.now()):(this.serverCurrentSessionSeconds=0,this.serverReceivedAt=0),this.updateFocusDisplay(),this.updateTaskBubble({isFocusing:e,taskName:t?.taskName})}getDisplayTime(){if(this.isFocusing&&this.serverReceivedAt>0){let e=Math.floor((Date.now()-this.serverReceivedAt)/1e3);return this.baseFocusSeconds+this.serverCurrentSessionSeconds+e}return this.baseFocusSeconds}updateFocusDisplay(){this.updateFocusTime(this.getDisplayTime())}getFocusState(){return this.isFocusing}destroy(){super.destroy()}updateState(e){this.body?(super.update(),i.Math.Distance.Between(this.container.x,this.container.y,e.x,e.y)>50&&this.container.setPosition(e.x,e.y),this.container.x=i.Math.Linear(this.container.x,e.x,.1),this.container.y=i.Math.Linear(this.container.y,e.y,.1),this.body.setVelocity(0),e.isMoving?(e.direction.includes("left")&&(this.body.setVelocityX(-this.speed),this.playAnimation("walk-left")),e.direction.includes("right")&&(this.body.setVelocityX(this.speed),this.playAnimation("walk-right")),e.direction.includes("up")&&(this.body.setVelocityY(-this.speed),this.playAnimation("walk-up")),e.direction.includes("down")&&(this.body.setVelocityY(this.speed),this.playAnimation("walk-down"))):(this.stopAnimation(),this.container.setPosition(e.x,e.y)),this.updatePetPosition(e.direction)):f.K.error("RemotePlayer body not found")}}var y=s(2463),w=s(3738),j=s(2312),N=s(9251);class S{constructor(e,t,s){this.otherPlayers=new Map,this.roomId="",this.isSessionReplaced=!1,this.isInitialized=!1,this.currentMapIndex=0,this.mapSwitchTimeout=null,this.avatarLoaderListeners=new Map,this.avatarLoadingKeys=new Set,this.scene=e,this.username=t,this.getPlayer=s}clearMapSwitchTimeout(){this.mapSwitchTimeout&&(clearTimeout(this.mapSwitchTimeout),this.mapSwitchTimeout=null)}setWalls(e){this.walls=e}getRoomId(){return this.roomId}emitJoining(){let e=(0,o.Ol)(),t=this.getPlayer();if(!e||!t)return;let s=N.K.getState().pendingRoomId,a={x:t.getContainer().x,y:t.getContainer().y,username:this.username,startAt:(0,c.DF)()};s&&(a.roomId=s,N.K.getState().setPendingRoomId(null)),e.emit("joining",a)}connect(e){let t=(0,o.cH)();t&&(t.on("connect",()=>{w.d.getState().setDisconnected(!1),this.isSessionReplaced=!1,this.otherPlayers.forEach(e=>e.destroy()),this.otherPlayers.clear();let e=this.getPlayer();e&&t.id&&(e.id=t.id),e&&(window.dispatchEvent(new Event("reset_media")),g.d.getState().stopAllTasks(),window.dispatchEvent(new Event("channel_transition_complete")),this.emitJoining())}),t.on("auth_expired",()=>{window.location.href="/login"}),t.on("disconnect",async e=>{if(!this.isSessionReplaced&&"io client disconnect"!==e){try{let e=await fetch("/auth/me",{credentials:"include"});if(401===e.status){window.location.href="/login";return}}catch{}w.d.getState().setDisconnected(!0)}}),t.on("joined",e=>{this.roomId=e.roomId,N.K.getState().setRoomId(e.roomId);let t=this.getPlayer();t&&t.setRoomId(e.roomId),e.focusTime&&x.O.getState().syncFromServer(e.focusTime)}),t.on("session_replaced",()=>{this.isSessionReplaced=!0,this.clearMapSwitchTimeout(),t.disconnect(),e.showSessionEndedOverlay()}),t.on("players_synced",e=>{e.forEach(e=>{this.addRemotePlayer(e)})}),t.on("player_joined",e=>{this.addRemotePlayer(e)}),t.on("moved",e=>{let t=this.otherPlayers.get(e.userId);t&&void 0!==e.isMoving&&void 0!==e.direction&&t.updateState({x:e.x,y:e.y,isMoving:e.isMoving,direction:e.direction})}),t.on("player_left",e=>{let t=this.otherPlayers.get(e.userId);t&&(this.cleanupAllAvatarListeners(e.userId),t.destroy(),this.otherPlayers.delete(e.userId))}),t.on("join_failed",e=>{console.warn("[SocketManager] join_failed:",e),"ROOM_NOT_FOUND"===e.code?(alert("유효하지 않은 방입니다. 다시 로그인해주세요."),window.location.href="/login"):"ROOM_FULL"===e.code&&(alert("방이 꽉 찼습니다. 다른 채널을 선택해주세요."),d.K.getState().openModal(d.e.CHANNEL_SELECT))}),t.on("game_state",t=>{if(y.M.getState().setProgress(t.progress),y.M.getState().setMapIndex(t.mapIndex),y.M.getState().setProgressThreshold(t.progressThreshold),j.$.getState().setContributions(t.contributions),!this.isInitialized){this.isInitialized=!0,this.currentMapIndex=t.mapIndex,e.onInitialMapLoad(t.mapIndex);return}t.mapIndex!==this.currentMapIndex&&(e.onMapSyncRequired(t.mapIndex),this.currentMapIndex=t.mapIndex)}),t.on("progress_update",t=>{y.M.getState().setProgress(t.targetProgress),y.M.getState().setMapIndex(t.mapIndex),y.M.getState().setProgressThreshold(t.progressThreshold),j.$.getState().setContributions(t.contributions),t.mapIndex!==this.currentMapIndex&&(e.onMapSyncRequired(t.mapIndex),this.currentMapIndex=t.mapIndex)}),t.on("map_switch",t=>{this.mapSwitchTimeout&&clearTimeout(this.mapSwitchTimeout),this.mapSwitchTimeout=setTimeout(()=>{t.mapIndex!==this.currentMapIndex&&(this.currentMapIndex=t.mapIndex,e.onMapSwitch(t.mapIndex))},1e3)}),t.on("season_reset",t=>{y.M.getState().setProgress(0),j.$.getState().reset(),this.currentMapIndex=t.mapIndex,e.onMapSyncRequired(t.mapIndex)}),t.on("chatted",e=>{let t=this.otherPlayers.get(e.userId);t&&t.showChatBubble(e.message)}),t.on("focused",e=>{if(e.status!==x.M.FOCUSING)return;let t=this.otherPlayers.get(e.userId);t&&t.setFocusState(!0,{taskName:e.taskName,totalFocusSeconds:e.totalFocusSeconds??0,currentSessionSeconds:e.currentSessionSeconds??0})}),t.on("rested",e=>{if(e.status!==x.M.RESTING)return;let t=this.otherPlayers.get(e.userId);t&&t.setFocusState(!1,{totalFocusSeconds:e.totalFocusSeconds??0})}),t.on("focus_task_updated",e=>{let t=this.otherPlayers.get(e.userId);t&&t.updateTaskBubble({isFocusing:!0,taskName:e.taskName})}),t.on("pet_equipped",e=>{let t=this.otherPlayers.get(e.userId);t&&t.setPet(e.petImage)}),t.on("player_music_status",e=>{let t=this.otherPlayers.get(e.userId);t&&t.setMusicStatus(e.isListening)}))}addRemotePlayer(e){if(this.otherPlayers.has(e.userId))return;let t=this.getPlayer();if(t&&t.id===e.userId)return;let s=e.username||"unknown",a=new v(this.scene,e.x,e.y,s,e.userId,s,e.playerId??0);this.otherPlayers.set(e.userId,a),a.setFocusState(e.status===x.M.FOCUSING,{totalFocusSeconds:e.totalFocusSeconds??0,currentSessionSeconds:e.currentSessionSeconds??0,taskName:e.taskName??void 0}),e.petImage&&a.setPet(e.petImage),void 0!==e.isListening&&a.setMusicStatus(e.isListening),this.walls&&this.scene.physics.add.collider(a.getContainer(),this.walls),this.loadAvatar(e,a)}loadAvatar(e,t){let s=e.userId,a=e.username||"unknown",r=`avatar_${s}`;if(this.scene.textures.exists(r))return void t.updateFaceTexture(r);let i=this.scene.load,n=this.avatarLoadingKeys.has(r),l=()=>{this.avatarLoadingKeys.delete(r),this.removeAvatarListener(s,o,c,r)},o=e=>{e.key===r&&(console.error(`[SocketManager] Avatar load error for ${r}:`,e),l())},c=()=>{l();let e=this.otherPlayers.get(s);e&&e.updateFaceTexture(r)};if(this.addAvatarListener(s,{errorListener:o,completeListener:c,textureKey:r}),i.on("loaderror",o),i.once(`filecomplete-image-${r}`,c),!n){this.avatarLoadingKeys.add(r);let e=`https://avatars.githubusercontent.com/${a}`;i.image(r,e),i.isLoading()||i.start()}}addAvatarListener(e,t){let s=this.avatarLoaderListeners.get(e)||[];s.push(t),this.avatarLoaderListeners.set(e,s)}removeAvatarListener(e,t,s,a){let r=this.avatarLoaderListeners.get(e);if(!r)return;this.scene?.load&&(this.scene.load.off("loaderror",t),this.scene.load.off(`filecomplete-image-${a}`,s));let i=r.filter(e=>e.errorListener!==t&&e.completeListener!==s);i.length>0?this.avatarLoaderListeners.set(e,i):this.avatarLoaderListeners.delete(e)}cleanupAllAvatarListeners(e){let t=this.avatarLoaderListeners.get(e);t&&this.scene?.load&&(t.forEach(({errorListener:e,completeListener:t,textureKey:s})=>{this.scene.load.off("loaderror",e),this.scene.load.off(`filecomplete-image-${s}`,t),this.avatarLoadingKeys.delete(s)}),this.avatarLoaderListeners.delete(e))}setupCollisions(){this.otherPlayers.forEach(e=>{this.walls&&this.scene.physics.add.collider(e.getContainer(),this.walls)})}getRemotePlayers(){return this.otherPlayers}updateRemotePlayers(){this.otherPlayers.forEach(e=>{e.update(),e.updateFocusDisplay()})}sendChat(e){let t=this.getPlayer();if(!t)return;t.showChatBubble(e);let s=(0,o.Ol)();s&&s.emit("chatting",{message:e})}sendRespawnPosition(e,t){let s=(0,o.Ol)();s&&s.emit("moving",{x:e,y:t,isMoving:!1,direction:"down",timestamp:Date.now()})}destroy(){this.clearMapSwitchTimeout(),this.avatarLoaderListeners.forEach((e,t)=>{this.cleanupAllAvatarListeners(t)}),this.avatarLoadingKeys.clear(),this.otherPlayers.forEach(e=>e.destroy()),this.otherPlayers.clear()}}class k{constructor(e,t){this.input=null,this.scene=e,this.sendMessage=t}setup(){let e=document.getElementById("chat-input");e&&e.remove();let t=document.createElement("input");t.id="chat-input",t.type="text",t.className="absolute bottom-[100px] left-1/2 -translate-x-1/2 w-[320px] p-3 text-base text-black border-4 border-gray-800 bg-white shadow-[4px_4px_0_0_rgba(0,0,0,0.5)] font-['NeoDunggeunmo',_Arial,_sans-serif] outline-none hidden z-[1000] placeholder:text-gray-400",t.placeholder="메시지를 입력하세요 (Enter로 전송)",t.maxLength=30,document.body.appendChild(t),this.input=t,this.scene.input.keyboard?.on("keydown-ENTER",()=>{document.activeElement!==t&&(t.style.display="block",t.focus(),this.scene.input.keyboard.enabled=!1)}),t.addEventListener("keydown",e=>{e.stopPropagation(),"Enter"===e.key?(""!==t.value.trim()&&this.sendMessage(t.value),this.closeInput()):"Escape"===e.key&&this.closeInput()}),this.scene.events.on(i.Scenes.Events.SHUTDOWN,()=>{this.destroy()})}closeInput(){this.input&&(this.input.value="",this.input.style.display="none",this.input.blur(),setTimeout(()=>{this.scene&&this.scene.input&&this.scene.input.keyboard&&(this.scene.input.keyboard.enabled=!0)},100))}destroy(){this.input&&(this.input.remove(),this.input=null)}}class T{constructor(e){this.minZoom=.7,this.maxZoom=2,this.mapWidth=0,this.mapHeight=0,this.scene=e}setup(e,t,s){this.mapWidth=e,this.mapHeight=t,this.scene.cameras.main.setBounds(0,0,e,t),this.scene.cameras.main.centerOn(e/2,t/2),s&&this.scene.cameras.main.startFollow(s,!0,.05,.05),this.setInitialZoom(e,t),this.scene.input.on("wheel",this.handleZoom,this),this.scene.scale.on("resize",this.handleResize,this)}setInitialZoom(e,t){let s=this.scene.scale.width,a=this.scene.scale.height,r=Math.min(s/e,a/t);this.minZoom=r,this.scene.cameras.main.setZoom(r);let i=e*r,n=t*r,l=(s-i)/2/r,o=(a-n)/2/r;this.scene.cameras.main.setBounds(-l,-o,e+2*l,t+2*o),this.scene.cameras.main.centerOn(e/2,t/2)}handleResize(){this.mapWidth>0&&this.mapHeight>0&&this.setInitialZoom(this.mapWidth,this.mapHeight)}handleZoom(e,t,s,a){let r=this.scene.cameras.main.zoom,i=Math.max(this.minZoom,Math.min(this.maxZoom,r+(a>0?-.2:.2)));this.scene.cameras.main.setZoom(i)}updateBounds(e,t){this.mapWidth=e,this.mapHeight=t,this.scene.cameras.main.setBounds(0,0,e,t),this.setInitialZoom(e,t)}destroy(){this.scene.input.off("wheel",this.handleZoom,this),this.scene.scale.off("resize",this.handleResize,this)}}var _=s(9393);class I{constructor(e){this.isTransitioning=!1,this.scene=e,this.graphics=this.scene.make.graphics({x:0,y:0},!1),this.mask=new i.Display.Masks.GeometryMask(this.scene,this.graphics),this.mask.setInvertAlpha(!1)}close(e,t,s=1e3,a){if(this.isTransitioning)return;this.isTransitioning=!0,this.scene.cameras.main.setMask(this.mask);let{width:r,height:i}=this.scene.cameras.main,n={radius:Math.sqrt(r*r+i*i)};this.scene.tweens.add({targets:n,radius:0,duration:s,ease:"Power2",onUpdate:()=>{this.graphics.clear(),this.graphics.fillCircle(e,t,n.radius)},onComplete:()=>{a?.()}})}open(e,t,s=1e3,a){this.scene.cameras.main.setMask(this.mask);let{width:r,height:i}=this.scene.cameras.main,n=Math.sqrt(r*r+i*i),l={radius:0};this.scene.tweens.add({targets:l,radius:n,duration:s,ease:"Power2",onUpdate:()=>{this.graphics.clear(),this.graphics.fillCircle(e,t,l.radius)},onComplete:()=>{this.isTransitioning=!1,this.scene.cameras.main.clearMask(),this.graphics.clear(),a?.()}})}setMask(e,t,s){this.scene.cameras.main.setMask(this.mask),this.graphics.clear(),this.graphics.fillCircle(e,t,s)}destroy(){this.graphics.destroy(),this.scene.cameras.main.clearMask()}}class E extends i.Scene{constructor(){super({key:"MogakcoScene"}),this.username="",this.playerId=0,this.maps=[{image:"tiles1",tilemap:"tilemap1",imagePath:`${_.H$}/api/maps/0`,tilemapPath:"/assets/tilemaps/desert_stage1.json"},{image:"tiles2",tilemap:"tilemap2",imagePath:`${_.H$}/api/maps/1`,tilemapPath:"/assets/tilemaps/desert_stage2.json"},{image:"tiles3",tilemap:"tilemap3",imagePath:`${_.H$}/api/maps/2`,tilemapPath:"/assets/tilemaps/desert_stage3.json"},{image:"tiles4",tilemap:"tilemap4",imagePath:`${_.H$}/api/maps/3`,tilemapPath:"/assets/tilemaps/desert_stage4.json"},{image:"tiles5",tilemap:"tilemap5",imagePath:`${_.H$}/api/maps/4`,tilemapPath:"/assets/tilemaps/desert_stage5.json"}],this.petImage=null,this.lastTaskBubbleState=null}preload(){this.load.crossOrigin="anonymous",this.maps.forEach(e=>{e.tilemapPath&&this.load.tilemapTiledJSON(e.tilemap,e.tilemapPath)}),this.load.spritesheet("body","/assets/body.png",{frameWidth:64,frameHeight:64});let e=this.username||"boostcampwm2025";this.load.image("face",`https://avatars.githubusercontent.com/${e}`),this.load.svg("pet","/assets/mascot/gopher_stage1.svg",{width:512,height:512});for(let e=1;e<=4;e++)this.load.image(`note${e}`,`/assets/music/note/note${e}.png`)}init(){let e=this.registry.get("user");this.username=e?.username,this.playerId=e?.playerId??0,this.petImage=e?.petImage}create(){if(!this.textures.exists("music_notes_atlas")){let e=this.textures.createCanvas("music_notes_atlas",160,32);if(e){let t=e.getContext();for(let s=1;s<=4;s++){let a=`note${s}`;if(this.textures.exists(a)){let r=this.textures.get(a).getSourceImage(),i=(s-1)*32,n=r.width||32,l=r.height||32,o=Math.min(24/n,24/l),c=n*o,d=l*o,h=i+4+(24-c)/2,m=4+(24-d)/2;t.drawImage(r,h,m,c,d),e.add(s-1,0,i,0,32,32)}}e.refresh()}}this.mapManager=new b(this,this.maps);let e=e=>{this.player&&e.detail?.petImage&&this.player.setPet(e.detail.petImage)};window.addEventListener("local_pet_update",e);let t=e=>{this.player&&e.detail?.isListening!==void 0&&this.player.setMusicStatus(e.detail.isListening)};window.addEventListener("local_music_update",t),this.events.once("destroy",()=>{window.removeEventListener("local_pet_update",e),window.removeEventListener("local_music_update",t)}),this.createAnimations(),this.setupControls(),this.socketManager=new S(this,this.username,()=>this.player),this.socketManager.connect({showSessionEndedOverlay:()=>this.showSessionEndedOverlay(),onMapSwitch:e=>this.performMapSwitch(e),onMapSyncRequired:e=>this.performMapSwitch(e),onInitialMapLoad:e=>this.initializeWithMap(e)}),this.chatManager=new k(this,e=>this.socketManager.sendChat(e)),this.chatManager.setup(),this.irisTransition=new I(this);let s=e=>{let t=e.detail?.onComplete;if(this.player){let{x:e,y:s}=this.player.getContainer();this.irisTransition.close(e+200,s+100,1e3,()=>{t&&t()})}else t&&t()};window.addEventListener("start_channel_transition",s);let a=()=>{if(this.player){let{x:e,y:t}=this.player.getContainer();this.irisTransition.open(e+200,t+100,2e3)}};window.addEventListener("channel_transition_complete",a),this.events.once("destroy",()=>{window.removeEventListener("start_channel_transition",s),window.removeEventListener("channel_transition_complete",a),this.irisTransition?.destroy()}),this.events.on("shutdown",this.cleanup,this)}initializeWithMap(e){(e<0||e>=this.maps.length)&&(console.warn(`[MapScene] Invalid mapIndex from server: ${e}, using 0`),e=0),this.mapManager.loadAndSetup(e,()=>{if(this.setupPlayer(),this.socketManager.emitJoining(),this.player){let{x:e,y:t}=this.player.getContainer();this.irisTransition.open(e+200,t+100,1e3)}this.setupCollisions(),this.cameraController=new T(this);let{width:e,height:t}=this.mapManager.getMapSize();this.cameraController.setup(e,t,this.player?.getContainer()),this.socketManager.setWalls(this.mapManager.getWalls())})}cleanup(){this.cameraController?.destroy(),this.events.off("shutdown",this.cleanup,this)}createAnimations(){this.anims.exists("walk-down")||this.anims.create({key:"walk-down",frames:this.anims.generateFrameNumbers("body",{start:0,end:3}),frameRate:10,repeat:-1}),this.anims.exists("walk-left")||this.anims.create({key:"walk-left",frames:this.anims.generateFrameNumbers("body",{start:4,end:7}),frameRate:10,repeat:-1}),this.anims.exists("walk-right")||this.anims.create({key:"walk-right",frames:this.anims.generateFrameNumbers("body",{start:8,end:11}),frameRate:10,repeat:-1}),this.anims.exists("walk-up")||this.anims.create({key:"walk-up",frames:this.anims.generateFrameNumbers("body",{start:12,end:15}),frameRate:10,repeat:-1})}setupPlayer(){let e=this.mapManager.getRandomSpawnPosition(),t=(0,o.Ol)(),s=t?.id||`guest-${Math.floor(1e3*Math.random())}`;this.player=new p(this,e.x,e.y,this.username,s,"pending",this.playerId),this.player.setRoomId("pending"),this.petImage&&this.player.setPet(this.petImage)}setupControls(){this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys(),this.wasdKeys={W:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.W),A:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.A),S:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.S),D:this.input.keyboard.addKey(i.Input.Keyboard.KeyCodes.D)})}performMapSwitch(e){this.mapManager.switchToMap(e,()=>{this.setupCollisions();let{width:e,height:t}=this.mapManager.getMapSize();if(this.cameraController.updateBounds(e,t),this.socketManager.setWalls(this.mapManager.getWalls()),this.socketManager.setupCollisions(),this.player){let e=this.mapManager.getRandomSpawnPosition();this.player.setPosition(e.x,e.y),this.socketManager.sendRespawnPosition(e.x,e.y),this.irisTransition.open(e.x,e.y+20,1e3)}})}setupCollisions(){let e=this.mapManager.getWalls();e&&this.player&&this.physics.add.collider(this.player.getContainer(),e)}showSessionEndedOverlay(){this.scene.pause();let e=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,this.cameras.main.width,this.cameras.main.height,0,.7);e.setScrollFactor(0),e.setDepth(1e3);let t=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"다른 탭에서 접속하여\n현재 세션이 종료되었습니다.",{fontSize:"24px",color:"#ffffff",align:"center"});t.setOrigin(.5),t.setScrollFactor(0),t.setDepth(1001)}update(){if(!this.player||!this.cursors)return;let e=x.O.getState().getFocusTime();this.player.updateFocusTime(e),this.updateTaskBubble(),this.player.update(this.cursors,this.wasdKeys),this.socketManager.updateRemotePlayers()}updateTaskBubble(){if(!this.player)return;let{isFocusTimerRunning:e}=x.O.getState(),t=g.d.getState().tasks.find(e=>e.isRunning),s=e||!!t,a=t?.description,r={isFocusing:s,taskName:a};(this.lastTaskBubbleState?.isFocusing!==r.isFocusing||this.lastTaskBubbleState?.taskName!==r.taskName)&&(this.lastTaskBubbleState=r,this.player.updateTaskBubble({isFocusing:s,taskName:a}))}}let C={type:i.AUTO,parent:"game-container",scale:{mode:i.Scale.RESIZE,width:"100%",height:"100%"},audio:{noAudio:!0},backgroundColor:"#303032",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[E]};var M=s(9873);function P(){let e=(0,r.useRef)(null),t=(0,M.n)(e=>e.user),{data:s}=(0,n.I)({queryKey:["player","info",t?.playerId],queryFn:()=>l.g.getPlayer(t.playerId),enabled:!!t?.playerId});return(0,r.useEffect)(()=>{if(e.current||!t||!s)return;e.current=new i.Game(C);let a=s.equippedPet?.actualImgUrl||null;e.current.registry.set("user",{...t,petImage:a})},[t,s]),(0,r.useEffect)(()=>()=>{e.current&&(e.current.destroy(!0),e.current=null)},[]),(0,a.jsx)("div",{id:"game-container",className:"h-full w-full"})}},8790:(e,t,s)=>{"use strict";s.d(t,{C0:()=>i.C0,WY:()=>r.W,ZG:()=>i.ZG,hD:()=>a.hD,m9:()=>i.m9,vk:()=>i.vk});var a=s(9393),r=s(8087);s(3532),s(6375),s(8145);var i=s(2393)},8986:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>i,c:()=>l,cH:()=>n});var a=s(5893);let r=null,i=()=>(r||(r=(0,a.io)("https://jandiplease.duckdns.org",{transports:["websocket"],withCredentials:!0,autoConnect:!1,reconnection:!1})),r),n=()=>{let e=i();return e.connected||e.connect(),e},l=(e,t)=>{let s=i();s.connected&&s.emit(e,t)}},9008:(e,t,s)=>{Promise.resolve().then(s.bind(s,8450)),Promise.resolve().then(s.bind(s,486)),Promise.resolve().then(s.bind(s,7337)),Promise.resolve().then(s.bind(s,8702)),Promise.resolve().then(s.bind(s,2005)),Promise.resolve().then(s.bind(s,5694)),Promise.resolve().then(s.bind(s,5136)),Promise.resolve().then(s.bind(s,2177)),Promise.resolve().then(s.bind(s,2654)),Promise.resolve().then(s.bind(s,9052)),Promise.resolve().then(s.bind(s,4071)),Promise.resolve().then(s.bind(s,820)),Promise.resolve().then(s.bind(s,9125))},9052:(e,t,s)=>{"use strict";s.d(t,{default:()=>v});var a=s(546),r=s(7335),i=s(6034),n=s(2983),l=s(842),o=s(1217),c=s(807),d=s(9873),h=s(8790);function m(e){return`https://github.com/${e}.png`}function u(e){return String(e).padStart(2,"0")}function p(e){return{playerId:e.playerId,rank:e.rank,username:e.nickname,profileImage:m(e.nickname),points:e.totalPoints}}function x(e){return{playerId:e.playerId,rank:e.rank,username:e.nickname,profileImage:m(e.nickname),points:e.count}}function g({player:e,className:t="",isMyRank:s=!1,selectedTab:r=h.vk.ALL}){var i,n,l;let o,c,d,m,u=1===(i=e.rank)?"text-yellow-500":2===i?"text-gray-400":3===i?"text-[#CD7F32]":"text-amber-900",p=(n=e.rank)<=3?`No.${n}`:n,x=r===h.vk.FOCUSED?(o=Math.floor((l=e.points)/3600),c=Math.floor(l%3600/60),d=l%60,m=[],o>0&&m.push(`${o}h`),c>0&&m.push(`${c}m`),(d>0||0===m.length)&&m.push(`${d}s`),m.join(" ")):e.points;return(0,a.jsxs)("div",{className:`grid grid-cols-4 items-center gap-2 py-2 rounded border-2 ${s?"border-blue-400 bg-blue-50":"border-amber-900/20 bg-amber-50 mb-2"} ${t}`,children:[(0,a.jsx)("span",{className:`text-center text-lg font-bold ${u}`,children:p}),(0,a.jsx)("div",{className:"flex justify-center",children:e.profileImage?(0,a.jsx)("img",{src:e.profileImage,alt:e.username,width:40,height:40,className:"h-10 w-10 rounded-full"}):(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-400 text-sm font-bold text-white",children:e.username.slice(0,2)})}),(0,a.jsx)("span",{className:"text-center font-medium text-amber-900",children:e.username}),(0,a.jsx)("span",{className:"text-center font-bold text-amber-900",children:x})]})}var b=s(5331);let f="border-3 border-amber-900";function v(){let{activeModal:e,closeModal:t}=(0,r.K)((0,n.k)(e=>({activeModal:e.activeModal,closeModal:e.closeModal}))),s=e===r.e.LEADERBOARD,[v,y]=(0,l.useState)(0),[w,j]=(0,l.useState)(h.vk.ALL),{contentRef:N,handleClose:S,handleBackdropClick:k}=(0,i.T)({isOpen:s,onClose:t}),T=(0,d.n)(e=>e.user),_=(0,l.useMemo)(()=>(0,c.vc)(),[]),{ranks:I,isLoading:E}=(0,o.Pe)(_,w,s),[C,M]=(0,l.useState)(null);(0,l.useEffect)(()=>{var e,t,a,r;let i,n;if(!s||E||!I)return;let l=w===h.vk.ALL;M({seasonEndTime:(0,c.aJ)(),players:l?I.map(p):I.map(x),myRank:l?(e=T?.playerId,t=T?.username,(i=I.find(t=>t.playerId===e))?p(i):{playerId:e||0,rank:I.length+1,username:t||"Unknown",profileImage:t?m(t):null,points:0}):(a=T?.playerId,r=T?.username,(n=I.find(e=>e.playerId===a))?x(n):{playerId:a||0,rank:I.length+1,username:r||"Unknown",profileImage:r?m(r):null,points:0})})},[s,E,I,T,w]),(0,l.useEffect)(()=>{s||M(null)},[s]);let P=(0,l.useMemo)(()=>C?function(e){let t=new Date(e).getTime()-Date.now();if(t<=0)return{days:0,hours:0,minutes:0,seconds:0};let s=Math.floor(t/864e5),a=Math.floor(t%864e5/36e5);return{days:s,hours:a,minutes:Math.floor(t%36e5/6e4),seconds:Math.floor(t%6e4/1e3)}}(C.seasonEndTime):{days:0,hours:0,minutes:0,seconds:0},[C,v]);return((0,l.useEffect)(()=>{if(!s||!C)return;let e=setInterval(()=>{y(e=>e+1)},1e3);return()=>clearInterval(e)},[s,C]),s&&C)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-10",onClick:k,children:(0,a.jsxs)("div",{ref:N,role:"dialog","aria-modal":"true","aria-labelledby":"leaderboard-title",className:`relative w-full max-w-lg bg-[#ffecb3] ${f} p-4 shadow-[8px_8px_0px_0px_rgba(0,0,0,0.5)]`,children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h2",{id:"leaderboard-title",className:"text-xl font-extrabold tracking-wider text-amber-900",children:"주간 순위표"}),(0,a.jsx)("button",{onClick:S,"aria-label":"리더보드 모달 닫기",className:`flex h-8 w-8 cursor-pointer items-center justify-center ${f} bg-red-400 leading-none font-bold text-white shadow-[2px_2px_0px_0px_rgba(30,30,30,0.3)] hover:bg-red-500 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none`,children:"X"})]}),(0,a.jsxs)("div",{className:"mb-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-amber-700",children:"현재 시즌 타이머"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-amber-900",children:[P.days,"day : ",u(P.hours)," :"," ",u(P.minutes)," : ",u(P.seconds)]})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("div",{className:"flex flex-wrap justify-center gap-1.5",children:Object.entries(h.vk).map(([e,t])=>(0,a.jsx)("button",{onClick:()=>j(t),onKeyDown:e=>{"Enter"===e.key&&(e.stopPropagation(),j(t))},className:`${f} w-[calc(25%-0.375rem)] cursor-pointer py-2.5 text-sm font-bold whitespace-nowrap transition-all ${w===t?"translate-y-[1px] bg-amber-700 text-white shadow-[3px_3px_0px_0px_rgba(0,0,0,0.4)]":"bg-white text-amber-900 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.2)] hover:bg-amber-50 active:translate-y-[1px]"}`,children:h.C0[t]},e))})}),(0,a.jsxs)("div",{className:`${f} relative overflow-hidden bg-white/50 p-3`,children:[(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 opacity-5",style:{backgroundImage:`repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                #d4a574 10px,
                #d4a574 20px
              )`}}),(0,a.jsxs)("h3",{className:"relative mb-3 flex items-center justify-center gap-3 py-3 text-center text-lg font-bold text-amber-900",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 animate-pulse text-amber-600"}),(0,a.jsx)("span",{children:h.ZG[w]}),(0,a.jsx)(b.A,{className:"h-4 w-4 animate-pulse text-amber-600"})]}),(0,a.jsxs)("div",{className:"mb-2 grid grid-cols-4 gap-2 border-b-2 border-amber-900/30 pb-2 text-sm font-bold text-amber-700",children:[(0,a.jsx)("span",{className:"text-center",children:"순위"}),(0,a.jsx)("span",{className:"text-center",children:"프로필"}),(0,a.jsx)("span",{className:"text-center",children:"깃허브 네임"}),(0,a.jsx)("span",{className:"text-center",children:w===h.vk.ALL?"포인트":w===h.vk.FOCUSED?"시간":"횟수"})]}),(0,a.jsx)("div",{className:"retro-scrollbar max-h-60 space-y-2 overflow-y-auto",children:0===C.players.length?(0,a.jsx)("div",{className:"py-8 text-center text-sm text-amber-700",children:"아직 이번 주 랭킹 데이터가 없습니다."}):C.players.map(e=>(0,a.jsx)(g,{player:e,selectedTab:w},e.playerId))}),(0,a.jsx)("div",{className:"border-t-2 border-amber-900/30 pt-3",children:(0,a.jsx)(g,{player:C.myRank,isMyRank:!0,selectedTab:w})})]})]})}):null}},9125:(e,t,s)=>{"use strict";s.d(t,{default:()=>em});var a=s(546),r=s(7335),i=s(9873),n=s(6034),l=s(9147),o=s(4816),c=s(2619),d=s(842),h=s(8143),m=s(8986),u=s(9141);let p=e=>{let t=(0,l.jE)(),{data:s=[],isLoading:a}=(0,o.I)({queryKey:u.l.pets.inventory(e),queryFn:()=>h.g.getInventory(e),enabled:!!e,staleTime:0}),{data:r=[],isLoading:i}=(0,o.I)({queryKey:u.l.pets.codex(e),queryFn:()=>h.g.getCodex(e),enabled:!!e,staleTime:0}),{data:n,isLoading:p}=(0,o.I)({queryKey:u.l.player.info(e),queryFn:()=>h.g.getPlayer(e),enabled:!!e,staleTime:0}),{data:x=[],isLoading:g}=(0,o.I)({queryKey:u.l.pets.allPets(),queryFn:h.g.getAllPets,staleTime:36e5}),b=(0,c.n)({mutationFn:h.g.gacha,onSuccess:()=>{t.invalidateQueries({queryKey:u.l.player.info(e)})}}),f=(0,d.useCallback)(()=>{t.invalidateQueries({queryKey:u.l.pets.inventory(e)}),t.invalidateQueries({queryKey:u.l.pets.codex(e)})},[t,e]),v=(0,c.n)({mutationFn:h.g.gachaRefund,onSuccess:()=>{t.invalidateQueries({queryKey:u.l.player.info(e)})}}),y=(0,c.n)({mutationFn:e=>h.g.feed(e),onSuccess:()=>{t.invalidateQueries({queryKey:u.l.pets.inventory(e)}),t.invalidateQueries({queryKey:u.l.player.info(e)})}}),w=(0,c.n)({mutationFn:e=>h.g.evolve(e),onSuccess:()=>{t.invalidateQueries({queryKey:u.l.pets.inventory(e)}),t.invalidateQueries({queryKey:u.l.pets.codex(e)})}}),j=(0,c.n)({mutationFn:e=>h.g.equipPet(e),onSuccess:(s,a)=>{t.invalidateQueries({queryKey:u.l.player.info(e)});let r=(0,m.Ol)();if(r?.connected&&r.emit("pet_equipping",{petId:a}),!x||0===x.length)return void console.warn("allPets not loaded yet for local update");let i=x.find(e=>e.id===a);if(i&&1){let e=i.actualImgUrl;window.dispatchEvent(new CustomEvent("local_pet_update",{detail:{petImage:e}}))}}});return{inventory:s,codex:r,allPets:x,player:n,isLoading:a||i||p||g,gacha:b.mutateAsync,gachaRefund:v.mutateAsync,refreshPets:f,feed:y.mutateAsync,evolve:w.mutateAsync,equip:j.mutateAsync}};var x=s(2983),g=s(2822),b=s(2167),f=s(8601),v=s(4189),y=s(8145);function w(){let{targetUsername:e,targetPlayerId:t}=(0,r.K)((0,x.k)(e=>({targetUsername:e.userInfoPayload?.username,targetPlayerId:e.userInfoPayload?.playerId}))),{user:s,logout:n}=(0,i.n)((0,x.k)(e=>({user:e.user,logout:e.logout}))),o=!t||t===s?.playerId,h=e??s?.username??"",{user:m}=(0,v.gJ)(h),{isFollowing:p,isLoading:w}=(0,v.X8)(o?"":h),{handleFollowToggle:j,isSubmitting:N}=function(e){let t=(0,l.jE)(),[s,a]=(0,d.useState)(!1),r=(0,c.n)({mutationFn:()=>y.M.followUser(e),onMutate:async()=>{await t.cancelQueries({queryKey:u.l.github.followStatus(e)}),await t.cancelQueries({queryKey:u.l.github.user(e)});let s=t.getQueryData(u.l.github.followStatus(e)),a=t.getQueryData(u.l.github.user(e));return t.setQueryData(u.l.github.followStatus(e),{isFollowing:!0}),a&&t.setQueryData(u.l.github.user(e),{...a,followers:a.followers+1}),{previousStatus:s,previousUser:a}},onError:(s,a,r)=>{r?.previousStatus&&t.setQueryData(u.l.github.followStatus(e),r.previousStatus),r?.previousUser&&t.setQueryData(u.l.github.user(e),r.previousUser)}}),i=(0,c.n)({mutationFn:()=>y.M.unfollowUser(e),onMutate:async()=>{await t.cancelQueries({queryKey:u.l.github.followStatus(e)}),await t.cancelQueries({queryKey:u.l.github.user(e)});let s=t.getQueryData(u.l.github.followStatus(e)),a=t.getQueryData(u.l.github.user(e));return t.setQueryData(u.l.github.followStatus(e),{isFollowing:!1}),a&&t.setQueryData(u.l.github.user(e),{...a,followers:Math.max(0,a.followers-1)}),{previousStatus:s,previousUser:a}},onError:(s,a,r)=>{r?.previousStatus&&t.setQueryData(u.l.github.followStatus(e),r.previousStatus),r?.previousUser&&t.setQueryData(u.l.github.user(e),r.previousUser)}});return{handleFollowToggle:async e=>{if(!s){a(!0);try{e?await i.mutateAsync():await r.mutateAsync()}catch(e){console.error("팔로우 상태 변경 실패:",e)}finally{a(!1)}}},isSubmitting:s}}(h),S={avatarUrl:m?.avatar_url??s?.avatarUrl??"https://avatars.githubusercontent.com/u/0?v=4",githubUsername:m?.login??h??"Unknown",followers:m?.followers??0,following:m?.following??0};return(0,a.jsxs)("div",{className:"space-y-6 px-4 pt-20 pb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"h-24 w-24 overflow-hidden rounded-full shadow-[4px_4px_0px_0px_rgba(0,0,0,0.3)]",children:(0,a.jsx)("img",{src:S.avatarUrl,alt:`${S.githubUsername}의 프로필`,className:"h-full w-full object-cover"})}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)("a",{href:`https://github.com/${S.githubUsername}`,target:"_blank",rel:"noopener noreferrer",className:"relative cursor-pointer text-lg font-bold text-amber-900 transition-colors hover:text-amber-700",children:[S.githubUsername,(0,a.jsx)("span",{className:"absolute top-1/2 right-0 translate-x-[calc(100%+8px)] -translate-y-1/2",children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-900",children:S.followers}),(0,a.jsx)("div",{className:"text-sm text-amber-700",children:"팔로워"})]}),(0,a.jsx)("div",{className:"h-12 w-px bg-amber-900/20"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-900",children:S.following}),(0,a.jsx)("div",{className:"text-sm text-amber-700",children:"팔로잉"})]})]}),!o&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(f.$,{onClick:()=>j(p),disabled:w||N,className:`flex w-full cursor-pointer items-center justify-center gap-2 rounded-none border-2 py-2 font-bold transition-all active:translate-x-0.5 active:translate-y-0.5 active:shadow-none disabled:cursor-not-allowed disabled:opacity-50 ${p?"border-red-700 bg-red-600 text-white shadow-[4px_4px_0px_0px_#7f1d1d] hover:bg-red-700":"border-amber-900 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] hover:bg-amber-800"}`,children:w||N?"...":p?"언팔로우":"팔로우"})}),o&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)(f.$,{onClick:n,className:"flex w-full cursor-pointer items-center justify-center gap-2 rounded-none border-2 border-red-700 bg-red-600 py-2 font-bold text-white shadow-[4px_4px_0px_0px_#7f1d1d] transition-all hover:bg-red-700 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),"로그아웃"]})})]})}var j=s(4581),N=s(2688),S=s(807);function k(e,t){return!!t&&e.toDateString()===t.toDateString()}function T({day:e,position:t}){return(0,a.jsxs)("div",{className:"pointer-events-none fixed z-50 rounded-none border-2 border-amber-700 bg-amber-900 px-3 py-2 text-sm text-amber-50 shadow-[2px_2px_0px_0px_#000]",style:{left:t.x+10,top:t.y+10},children:[(0,a.jsx)("div",{children:e.date.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"})}),(0,a.jsxs)("div",{className:"mt-1 text-amber-300",children:["Point: ",e.value]})]})}var _=s(735);let I=[{action:"집중 30분",points:1},{action:"커밋",points:2},{action:"PR 생성",points:2},{action:"PR 머지",points:4},{action:"PR 리뷰",points:4},{action:"이슈 생성",points:1},{action:"Task 완료",points:1}];function E(){let[e,t]=(0,d.useState)(!1),[s,r]=(0,d.useState)({x:0,y:0}),i=(0,d.useRef)(null);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{ref:i,id:"heatmap-info-link",className:"flex cursor-pointer items-center gap-1 text-xs text-amber-700 transition-colors hover:text-amber-900",onMouseEnter:e=>{t(!0),r({x:e.clientX,y:e.clientY})},onMouseMove:e=>{r({x:e.clientX,y:e.clientY})},onMouseLeave:()=>{t(!1)},children:[(0,a.jsx)(_.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"포인트 획득 정책"})]}),e&&(0,a.jsxs)("div",{className:"pointer-events-none fixed z-50 rounded-none border-2 border-amber-700 bg-amber-900 px-3 py-2 text-sm text-amber-50 shadow-[2px_2px_0px_0px_#000]",style:{left:s.x+10,top:s.y+10},children:[(0,a.jsxs)("div",{className:"mb-2 flex justify-between gap-12 border-b border-amber-700 pb-1 font-bold text-amber-300",children:[(0,a.jsx)("span",{children:"활동"}),(0,a.jsx)("span",{children:"포인트"})]}),(0,a.jsx)("div",{className:"space-y-1",children:I.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,a.jsx)("span",{children:e.action}),(0,a.jsxs)("span",{className:"text-amber-300",children:["+",e.points,"P"]})]},t))})]})]})}let C={0:{imagePath:"/assets/grass/grass_level_0.webp",colorClass:"bg-heatmap-empty"},1:{imagePath:"/assets/grass/grass_level_1.webp",colorClass:"bg-heatmap-level-1"},2:{imagePath:"/assets/grass/grass_level_2.webp",colorClass:"bg-heatmap-level-2"},3:{imagePath:"/assets/grass/grass_level_3.webp",colorClass:"bg-heatmap-level-3"}};function M(e){return 0===e?0:e<=10?1:e<=30?2:3}let P=(0,d.memo)(function({day:e,selectedDate:t,onSelectDate:s,onMouseEnter:r,onMouseMove:i,onMouseLeave:n}){var l;let o=-1!==e.value;return(0,a.jsx)("div",{role:o?"button":void 0,tabIndex:o?0:void 0,"aria-label":o?`${e.date.toLocaleDateString()}: ${e.value} points`:void 0,className:`h-3 w-3 rounded-sm transition-colors ${-1===(l=e.value)?"bg-transparent":C[M(l)].colorClass} ${-1===e.value?"cursor-default":k(e.date,t)?"ring-2 ring-amber-900":"cursor-pointer ring-1 ring-amber-300 hover:ring-2 hover:ring-amber-800"}`,onClick:()=>o&&s(e.date),onKeyDown:t=>{o&&("Enter"===t.key||" "===t.key)&&(t.preventDefault(),s(e.date))},onMouseEnter:t=>r(t,e),onMouseMove:t=>i(t,e),onMouseLeave:n})});function D(){return(0,a.jsx)("div",{className:"mt-2 flex items-center justify-end gap-2 text-xs",children:(0,a.jsxs)("div",{className:"mr-10 flex items-center gap-2 text-amber-800",children:[(0,a.jsx)("span",{className:"opacity-80",children:"less"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"bg-heatmap-empty h-3 w-3 rounded-sm ring-1 ring-amber-300"}),(0,a.jsx)("div",{className:"bg-heatmap-level-1 h-3 w-3 rounded-sm ring-1 ring-amber-300"}),(0,a.jsx)("div",{className:"bg-heatmap-level-2 h-3 w-3 rounded-sm ring-1 ring-amber-300"}),(0,a.jsx)("div",{className:"bg-heatmap-level-3 h-3 w-3 rounded-sm ring-1 ring-amber-300"})]}),(0,a.jsx)("span",{className:"opacity-80",children:"more"})]})})}let A=["","Mon","","Wed","","Fri",""],R=(0,d.memo)(function({dailyPoints:e,onSelectDate:t,selectedDate:s}){let r,i,[n,l]=(0,d.useState)(0),[o,c]=(0,d.useState)(null),[h,m]=(0,d.useState)({x:0,y:0}),u=(0,d.useRef)(null),{weeks:p}=(r=(0,d.useMemo)(()=>{let t=[],s=new Date,a=new Date(s);a.setFullYear(s.getFullYear()-1);for(let r=new Date(a);r<=s;r.setDate(r.getDate()+1)){let s=(0,S.HN)(r);t.push({date:new Date(r),value:e.get(s)||0})}return t},[e]),i=(0,d.useMemo)(()=>{let e=[],t=[],s=r[0].date.getDay();for(let e=0;e<s;e++)t.push({date:new Date(0),value:-1});if(r.forEach(s=>{t.push(s),7===t.length&&(e.push(t),t=[])}),t.length>0){for(;t.length<7;)t.push({date:new Date(0),value:-1});e.push(t)}return e},[r]),{yearData:r,weeks:i}),x=e=>{let t=u.current;if(!t)return;let s="left"===e?Math.max(0,n-200):Math.min(t.scrollWidth-t.clientWidth,n+200);l(s),t.scrollTo({left:s,behavior:"smooth"})},g=(0,d.useCallback)((e,t)=>{-1!==t.value&&(0,d.startTransition)(()=>{c(t),m({x:e.clientX,y:e.clientY})})},[]),b=(0,d.useCallback)(()=>{c(null)},[]);(0,d.useEffect)(()=>{let e=u.current;if(!e)return;let t=e.scrollWidth-e.clientWidth;e.scrollTo({left:t,behavior:"auto"}),l(t)},[]);let v=new Map;return p.forEach((e,t)=>{if(e.some(e=>-1!==e.value&&1===e.date.getDate())){let s=e.find(e=>-1!==e.value&&1===e.date.getDate());if(s){let e=s.date.toLocaleDateString("en-US",{month:"short"});v.set(t,e)}}}),(0,a.jsxs)("div",{className:"mb-6 rounded-none border-2 border-amber-800/20 bg-amber-50 p-3",children:[(0,a.jsx)("div",{className:"mb-6 flex",children:(0,a.jsx)(E,{})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.$,{onClick:()=>x("left"),className:"mr-1 h-7 w-7 shrink-0 rounded-none border-2 border-amber-800 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] transition-all hover:bg-amber-800 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:(0,a.jsx)(j.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex flex-1 gap-1 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex shrink-0 flex-col pt-[21px]",children:A.map((e,t)=>(0,a.jsx)("div",{className:`flex h-3 items-center text-xs leading-3 font-bold text-amber-800 ${t<6?"mb-0.75":""}`,children:e},t))}),(0,a.jsx)("div",{ref:u,className:"scrollbar-hide flex-1 overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:(0,a.jsxs)("div",{className:"min-w-max",children:[(0,a.jsx)("div",{className:"mb-1 flex h-3",children:p.map((e,t)=>(0,a.jsx)("div",{className:"w-4 text-xs font-bold whitespace-nowrap text-amber-800",children:v.get(t)||""},`month-${t}`))}),(0,a.jsx)("div",{className:"inline-flex gap-1 px-1 pb-1",children:p.map((e,r)=>(0,a.jsx)("div",{className:"flex flex-col gap-0.75",children:e.map((e,i)=>(0,a.jsx)(P,{day:e,selectedDate:s,onSelectDate:t,onMouseEnter:g,onMouseMove:g,onMouseLeave:b},`${r}-${i}`))},r))})]})})]}),(0,a.jsx)(f.$,{onClick:()=>x("right"),className:"h-7 w-7 shrink-0 rounded-none border-2 border-amber-800 bg-amber-700 text-amber-50 shadow-[2px_2px_0px_0px_#78350f] transition-all hover:bg-amber-800 active:translate-x-0.5 active:translate-y-0.5 active:shadow-none",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(D,{}),o&&-1!==o.value&&(0,a.jsx)(T,{day:o,position:h})]})});var F=s(8169);function L({src:e,alt:t="Mascot"}){let[s,r]=(0,d.useState)(!1),[i,n]=(0,d.useState)(!1),[l,o]=(0,d.useState)(!1),[c,h]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=setInterval(()=>{h(!0),setTimeout(()=>h(!1),3e3)},5e3);return()=>clearInterval(e)},[]),(0,a.jsxs)("div",{className:"group relative size-full",children:[(0,a.jsx)("button",{onMouseEnter:()=>{r(!0),i||n(!0)},onMouseLeave:()=>{r(!1),o(!1)},onMouseDown:()=>o(!0),onMouseUp:()=>o(!1),className:`relative size-full cursor-pointer transition-transform select-none ${s?"translate-y-1":""} ${l?"scale-125":""} ${c?"animate-grass-pet-bounce":""}`,children:(0,a.jsx)(F.default,{src:e,alt:t,fill:!0,className:"object-contain select-none",draggable:!1})}),(0,a.jsx)("div",{className:`pointer-events-none absolute -top-4 left-1/2 transition-opacity duration-500 ${s?"opacity-80":"opacity-0"} ${i?"animate-grass-heart-float":""}`,children:(0,a.jsx)("div",{className:`transition-transform select-none ${l?"scale-125":""}`,children:(0,a.jsx)(F.default,{src:"/assets/heart.png",alt:"Heart",width:24,height:24,className:"object-contain select-none",draggable:!1})})})]})}function $({dailyPoints:e,selectedDate:t,playerId:s}){let r=function(e,t){return C[M(e.get(t)??0)].imagePath}(e,(0,S.HN)(t)),{data:i=[]}=(0,o.I)({queryKey:u.l.pets.inventory(s),queryFn:()=>h.g.getInventory(s),enabled:!!s,staleTime:0}),n=i.slice(0,9);return(0,a.jsxs)("div",{className:"relative size-60 shrink-0 overflow-visible rounded-none",children:[(0,a.jsx)(F.default,{src:r,alt:"Garden",fill:!0,className:"scale-115 object-fill",style:{imageRendering:"pixelated"},priority:!0}),(0,a.jsx)("div",{className:"relative grid h-full w-full grid-cols-3 grid-rows-3 p-2",children:Array.from({length:9}).map((e,t)=>(0,a.jsx)("div",{className:"relative flex items-center justify-center",children:n[t]&&(0,a.jsx)("div",{className:"size-14",children:(0,a.jsx)(L,{src:n[t].pet.actualImgUrl,alt:n[t].pet.name})})},t))})]})}function O({title:e,value:t,onClick:s,isSelected:r=!1}){let i=!!s;return(0,a.jsxs)("div",{className:`flex flex-col items-center justify-center rounded-none border-2 p-1 transition-all ${i?"cursor-pointer hover:border-amber-600 hover:bg-amber-100":""} ${r?"border-amber-600 bg-amber-100":"border-amber-800/20 bg-amber-50"}`,onClick:s,children:[(0,a.jsx)("h3",{className:"mb-1 text-xs font-bold",children:e}),(0,a.jsx)("p",{className:"text-sm text-amber-700",children:t})]})}function K(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60);return`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`}var q=s(8790);let U={TASK:"TASK",...q.m9},G=[{title:"집중 시간",valueKey:"focusTime",type:null},{title:"Task",valueKey:"task",type:U.TASK},{title:"커밋",valueKey:"commit",type:U.COMMITTED},{title:"이슈 생성",valueKey:"issue",type:U.ISSUE_OPEN},{title:"PR 생성",valueKey:"prCreated",type:U.PR_OPEN},{title:"PR 리뷰",valueKey:"prReviewed",type:U.PR_REVIEWED}];function B({tasks:e,selectedDate:t,focusTimeSeconds:s,githubEvents:r,dailyPoints:i,playerId:n,selectedCard:l,onCardSelect:o}){let c,d=K(s??0),h=k(t,new Date)?e.length:e.filter(e=>e.completed).length,m=(c={focusTime:d,task:String(h),commit:String(r?.committed??0),issue:String(r?.issueOpened??0),prCreated:String(r?.prCreated??0),prReviewed:String(r?.prReviewed??0)},G.map(e=>({title:e.title,value:c[e.valueKey],type:e.type})));return(0,a.jsxs)("div",{className:"flex h-60 gap-4",children:[(0,a.jsx)($,{dailyPoints:i,selectedDate:t,playerId:n}),(0,a.jsx)("div",{className:"grid h-full flex-1 grid-cols-3 grid-rows-2 gap-2",children:m.map((e,t)=>{let s=e.type;return(0,a.jsx)(O,{title:e.title,value:e.value,onClick:s?()=>o(s):void 0,isSelected:s===l},t)})})]})}function W({tasks:e,selectedDate:t}){let s,r=k(t,new Date),i=(s=(0,S.HN)(t),e.filter(e=>(0,S.HN)(new Date(e.createdAt))===s)).filter(e=>r||e.completed);return(0,a.jsxs)("div",{className:"rounded-none border-2 border-amber-800/20 bg-amber-50 p-3",children:[(0,a.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-bold",children:"Task 목록"}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:(0,S.pD)(t)})]}),(0,a.jsx)("div",{className:"space-y-2",children:0===i.length?(0,a.jsx)("div",{className:"py-4 text-center text-xs text-amber-700",children:"이 날짜에 등록된 Task가 없습니다."}):i.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-none border border-amber-200 bg-amber-100/50 p-2 transition-colors hover:border-amber-400",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,a.jsx)("div",{className:`h-3 w-3 rounded-none border-2 ${e.completed?"border-amber-700 bg-amber-600":"border-amber-400 bg-transparent"}`}),(0,a.jsx)("span",{className:`text-xs ${e.completed?"text-amber-600 line-through":"text-amber-900"}`,children:e.description})]}),(0,a.jsx)("span",{className:"text-xs text-amber-700",children:K(e.time)})]},e.id))})]})}var H=s(1217);let z={sm:"h-4 w-4 border-2",md:"h-8 w-8 border-2",lg:"h-12 w-12 border-4"};function Z({size:e="md",text:t,className:s=""}){return(0,a.jsxs)("div",{className:`flex flex-col items-center justify-center gap-3 ${s}`,children:[(0,a.jsx)("div",{className:`animate-spin rounded-full border-amber-300 border-t-amber-700 ${z[e]}`}),t&&(0,a.jsx)("span",{className:"text-sm text-amber-800",children:t})]})}let Y={[q.m9.COMMITTED]:q.m9.COMMITTED,[q.m9.ISSUE_OPEN]:q.m9.ISSUE_OPEN,[q.m9.PR_OPEN]:q.m9.PR_OPEN,[q.m9.PR_REVIEWED]:q.m9.PR_REVIEWED},X={[q.m9.COMMITTED]:"커밋",[q.m9.ISSUE_OPEN]:"이슈",[q.m9.PR_OPEN]:"PR 생성",[q.m9.PR_REVIEWED]:"PR 리뷰"},Q={[q.m9.COMMITTED]:"레포지토리 / 커밋 메시지",[q.m9.ISSUE_OPEN]:"레포지토리 / 이슈 제목",[q.m9.PR_OPEN]:"레포지토리 / PR 제목",[q.m9.PR_REVIEWED]:"레포지토리 / PR 제목"};function V({selectedCard:e,selectedDate:t,playerId:s}){let{gitEvents:r,isLoading:i}=(0,H.yu)(s,t),n=r.filter(t=>t.type===Y[e]).sort((e,t)=>new Date(t.activityAt||t.createdAt).getTime()-new Date(e.activityAt||e.createdAt).getTime());return i?(0,a.jsx)("div",{className:"rounded-none border-2 border-amber-800/20 bg-amber-50 p-3",children:(0,a.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,a.jsx)(Z,{size:"sm",text:"로딩 중..."})})}):(0,a.jsxs)("div",{className:"rounded-none border-2 border-amber-800/20 bg-amber-50 p-3",children:[(0,a.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm font-bold",children:[X[e]," 목록"]}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:(0,S.pD)(t)})]}),0===n.length?(0,a.jsxs)("div",{className:"py-4 text-center text-xs text-amber-700",children:["이 날짜에 ",X[e]," 기록이 없습니다."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2 border-b border-amber-300 px-2 pb-1 text-xs font-semibold text-amber-800",children:[(0,a.jsx)("span",{className:"flex-1",children:Q[e]}),(0,a.jsx)("span",{className:"w-36 text-center",children:"시간"}),(0,a.jsx)("span",{className:"w-16 text-center",children:"포인트"})]}),(0,a.jsx)("div",{className:"space-y-2",children:n.map(e=>{let t,s,r,i,n,l;return(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-none border border-amber-200 bg-amber-100/50 p-2 transition-colors hover:border-amber-400",children:[(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[e.repository&&(0,a.jsx)("span",{className:"text-xs font-semibold text-amber-900",children:e.repository}),e.description&&(0,a.jsx)("span",{className:"text-xs text-amber-700",children:e.description})]}),(0,a.jsx)("span",{className:"w-36 text-center text-xs text-amber-600",children:(s=(t=new Date(e.activityAt||e.createdAt)).getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0"),`${s}-${r}-${i} ${n}:${l}`)}),(0,a.jsxs)("span",{className:"w-16 text-center text-xs font-bold text-amber-700",children:["+",e.amount,"P"]})]},e.id)})})]})]})}function J({selectedCard:e,tasks:t,selectedDate:s,playerId:r}){return e===U.TASK?(0,a.jsx)(W,{tasks:t,selectedDate:s}):(0,a.jsx)(V,{selectedCard:e,selectedDate:s,playerId:r})}var ee=s(5349);function et(){let e=(0,r.K)(e=>e.userInfoPayload?.playerId),{user:t}=(0,i.n)(),s=e??t?.playerId??0,[n,l]=(0,d.useState)(new Date),[o,c]=(0,d.useState)(U.TASK),{dailyPoints:h,focusTimeData:m,githubEvents:u,tasks:p,isLoading:x}=function(e,t){let s=(0,S.HN)(t),{points:a,isLoading:r}=(0,H.wu)(e),{focustime:i,isLoading:n}=(0,H.fB)(e,s),{events:l,isLoading:o}=(0,H.iZ)(e,s),{tasks:c,isLoading:h}=(0,H.si)(e,s),m=(0,d.useMemo)(()=>c.map(ee.Y),[c]);return{dailyPoints:(0,d.useMemo)(()=>{let e=new Map;return a.forEach(t=>{let s=(0,S.HN)(new Date(t.createdAt));e.set(s,t.amount)}),e},[a]),focusTimeData:i,githubEvents:l,tasks:m,isLoading:r,isDateDataLoading:n||o||h}}(s,n);return x?(0,a.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,a.jsx)(Z,{size:"lg",text:"프로필 로딩 중..."})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(R,{dailyPoints:h,selectedDate:n,onSelectDate:l}),(0,a.jsxs)("div",{className:"space-y-4 text-amber-900",children:[(0,a.jsx)(B,{tasks:p,selectedDate:n,focusTimeSeconds:m?.totalFocusSeconds,githubEvents:u,dailyPoints:h,playerId:s,selectedCard:o,onCardSelect:c}),(0,a.jsx)(J,{selectedCard:o,tasks:p,selectedDate:n,playerId:s})]})]})}var es=s(9419),ea=s(1906);let er="bg-amber-600 px-4 py-2 hover:bg-amber-500 text-white border-b-4 border-r-4 border-amber-800 active:border-b-0 active:border-r-0 active:translate-y-1 active:translate-x-1 disabled:opacity-50 disabled:cursor-not-allowed",ei=(0,d.memo)(function({onPetCollected:e,onGacha:t,onGachaRefund:s,points:r,hasCollectedAllStage1:i=!1}){let[n,l]=(0,d.useState)("idle"),[o,c]=(0,d.useState)(null),[h,m]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),x=async()=>{if(r<100)return void alert("포인트가 부족합니다!");l("animating");try{let{pet:a,isDuplicate:r}=await t();if(await new Promise(e=>setTimeout(e,5e3)),r&&s&&await s(),a)c(a),m(r),l("result"),r?setTimeout(()=>p(!0),500):e(a.id);else throw Error("Unknown pet received")}catch(e){alert("뽑기 실패: "+e),l("idle")}};return(0,a.jsxs)("div",{className:"flex flex-col gap-4 bg-amber-50 p-6 border-4 border-amber-900",children:[(0,a.jsx)("div",{className:"flex items-center justify-between border-b-2 border-amber-900/20 pb-2",children:(0,a.jsx)("h3",{className:"text-xl font-bold text-amber-900",children:"펫 뽑기"})}),(0,a.jsxs)("div",{className:"flex h-60 flex-col items-center justify-center gap-4",children:["idle"===n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:`gacha-egg ${i?"opacity-50 grayscale":""}`}),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-center text-xs text-amber-600",children:["더 이상 뽑을 새로운 펫이 없습니다.",(0,a.jsx)("br",{}),"기존 펫을 성장시켜 진화해 보세요!"]}),(0,a.jsx)("button",{id:"pet-gacha-button",disabled:!0,className:er,children:"펫 뽑기"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-center text-sm text-amber-700",children:["어떤 펫이 나올까요?",(0,a.jsx)("br",{}),"(1회: 100 P)"]}),(0,a.jsx)("button",{id:"pet-gacha-button",onClick:x,disabled:r<100,className:er,children:"펫 뽑기"})]})]}),"animating"===n&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"gacha-egg animating"}),(0,a.jsx)("p",{className:"animate-pulse text-lg font-bold text-amber-800",children:"알이 깨지고 있어요!"})]}),"result"===n&&o&&(0,a.jsxs)("div",{className:"animate-pop flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"relative h-24 w-24",children:(0,a.jsx)(F.default,{src:o.actualImgUrl,alt:o.name,fill:!0,className:"object-contain",style:{imageRendering:"pixelated"}})}),(0,a.jsx)("div",{className:"flex flex-col items-center text-center",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"font-bold text-amber-700",children:"이미 함께하고 있는 친구네요!"}),(0,a.jsxs)("span",{className:"font mt-1 font-bold text-amber-800",children:["중복으로 뽑은 펫은"," ",(0,a.jsx)("span",{className:"font mt-1 rounded bg-amber-200 px-2 py-0.5 text-amber-800",children:"50P가 환급"})," ","됩니다."]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-lg font-bold text-amber-900",children:"축하합니다!"}),(0,a.jsxs)("p",{className:"text-sm text-amber-700",children:[(0,a.jsx)("span",{className:"font-bold text-amber-900",children:o.name}),"을(를) 만났습니다!"]})]})}),(0,a.jsx)(es.N,{children:u&&(0,a.jsxs)(ea.P.div,{initial:{opacity:0,y:0,scale:.5},animate:{opacity:1,y:-200,scale:1.2},exit:{opacity:0},transition:{duration:1.5,ease:"easeOut"},className:"absolute z-50 flex items-center gap-1 font-bold text-yellow-500 drop-shadow-md",style:{top:"40%"},onAnimationComplete:()=>p(!1),children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),(0,a.jsx)("span",{className:"text-xl",children:"+50P"})]})}),(0,a.jsx)("button",{onClick:()=>{l("idle"),c(null),m(!1),p(!1)},className:er,children:"확인"})]})]})]})}),en=(0,d.memo)(function({exp:e,maxExp:t,currentStageData:s,onAction:r,isOwner:i,points:n}){let[l,o]=(0,d.useState)([]),c=0===t,h=!c&&e>=t;return(0,a.jsxs)("div",{className:"flex gap-6 bg-amber-50 p-4 border-4 border-amber-900",children:[(0,a.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,a.jsxs)("div",{className:"relative h-32 w-32 drop-shadow-xl",children:[l.map(e=>(0,a.jsx)("div",{className:"flying-heart absolute size-10",style:{"--random-x":`${e.x}px`,left:"50%",top:"0"},children:(0,a.jsx)(F.default,{src:"/assets/heart.png",alt:"Heart",fill:!0,className:"object-contain",style:{imageRendering:"pixelated"}})},e.id)),(0,a.jsx)(F.default,{src:s.image,alt:s.name,fill:!0,className:"object-contain",style:{imageRendering:"pixelated"}})]})}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col justify-between text-sm font-bold",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-widest",children:s.name})}),(0,a.jsx)("p",{className:"text-sm text-amber-700",children:h?"✨ 진화가 가능합니다!":s.description}),(0,a.jsxs)("div",{className:"flex w-full items-end gap-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"mb-1 flex justify-between text-lg",children:[(0,a.jsx)("span",{children:"EXP"}),(0,a.jsx)("span",{children:c?"MAX":`${e} / ${t}`})]}),(0,a.jsxs)("div",{className:"relative h-6 w-full border-2 border-amber-900 bg-amber-900/10",children:[(0,a.jsx)("div",{className:`h-full transition-all duration-300 ease-out ${h?"animate-pulse bg-amber-500":"bg-green-500"}`,style:{width:c?"100%":`${e/t*100}%`}}),(0,a.jsx)("div",{className:"absolute inset-0 flex",children:[...Array(9)].map((e,t)=>(0,a.jsx)("div",{className:"flex-1 border-r border-amber-900/20"},t))})]})]}),i&&(0,a.jsx)("div",{className:"relative flex w-1/5 justify-center",children:(0,a.jsx)("button",{onClick:()=>{if(r(),!h&&!c){let e=Date.now(),t=40*Math.random()-20;o(s=>[...s,{id:e,x:t}]),setTimeout(()=>{o(t=>t.filter(t=>t.id!==e))},800)}},disabled:c||!h&&n<10,className:`flex h-12 w-full flex-col items-center justify-center rounded text-base leading-tight font-bold transition-all ${c||!h&&n<10?"cursor-not-allowed border-r-4 border-b-4 border-gray-600 bg-gray-400 text-white opacity-70":h?"border-r-4 border-b-4 border-amber-800 bg-amber-600 text-white hover:bg-amber-500 active:translate-x-1 active:translate-y-1 active:border-r-0 active:border-b-0":"bg-green-600 px-2 hover:bg-green-500 text-white border-b-4 border-r-4 border-green-800 active:border-b-0 active:border-r-0 active:translate-y-1 active:translate-x-1"}`,children:(0,a.jsx)("span",{children:h?"✨ 진화":"밥주기 (10 P)"})})})]})]})]})}),el=(0,d.memo)(function({allPets:e,collectedPetIds:t,equippedPetId:s,onPetSelect:r,isOwner:i}){let n=(0,d.useMemo)(()=>e.reduce((e,t)=>(e[t.species]||(e[t.species]=[]),e[t.species].push(t),e),{}),[e]);return(0,a.jsxs)("div",{className:"flex flex-col gap-4 bg-amber-50 p-6 border-4 border-amber-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b-2 border-amber-900/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-amber-900",children:"펫 도감"}),(0,a.jsxs)("span",{className:"text-xs font-bold text-amber-700",children:[t.length," / ",e.length," 수집"]})]}),(0,a.jsx)("div",{className:"flex h-auto flex-col gap-3",children:Object.entries(n).map(([e,n])=>(0,a.jsx)("div",{className:"flex flex-col gap-2 bg-amber-100/50 p-3 shadow-sm",children:(0,a.jsx)("div",{className:"grid w-full grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:n.map((e,l)=>{let o=t.includes(e.id),c=e.id===s,d=l===n.length-1;return(0,a.jsxs)("div",{className:"contents",children:[(0,a.jsxs)("div",{onClick:()=>o&&i&&r(e.id),className:`relative flex flex-col items-center justify-center bg-amber-100 p-2 aspect-auto hover:bg-amber-200 transition-colors border-2 border-amber-900/50 w-full ${o&&i?"cursor-pointer":o?"cursor-default":"bg-gray-200"} ${c?"border-amber-600 bg-amber-200":""}`,title:o?e.description:"???",children:[c&&(0,a.jsx)("div",{className:"absolute -top-2 -right-2 z-10 rotate-12 rounded border border-red-800 bg-red-500 px-1.5 py-0.5 text-[12px] font-bold text-white shadow-sm",children:"대표펫"}),(0,a.jsx)("div",{className:"relative mb-2 flex h-14 w-14 items-center justify-center",children:(0,a.jsx)("img",{src:o?e.actualImgUrl:e.silhouetteImgUrl,alt:o?e.name:"???",className:"h-full w-full object-contain"})}),(0,a.jsx)("p",{className:`w-full text-center text-xs font-bold ${o?"text-amber-900":"text-gray-500"}`,children:o?e.name:"???"})]}),!d&&(0,a.jsx)("div",{className:"flex justify-center text-amber-900/40",children:"▶"})]},e.id)})})},e))})]})});var eo=s(2590);function ec(){return(0,a.jsxs)("button",{onClick:()=>{window.open("https://github.com/boostcampwm2025/web19-estrogenquattro/blob/main/LICENSES.md","_blank","noopener,noreferrer")},className:"flex cursor-pointer items-center gap-1 text-xs text-amber-700 transition-colors hover:text-amber-900","aria-label":"라이선스 정보 보기",children:[(0,a.jsx)(eo.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"라이선스 정보"})]})}function ed(){let e=(0,r.K)(e=>e.userInfoPayload?.playerId),{user:t}=(0,i.n)(),s=e??0,n=t?.playerId===s,{inventory:l,codex:o,player:c,feed:h,evolve:m,equip:u,gacha:x,gachaRefund:g,refreshPets:b,allPets:f,isLoading:v}=p(s),[y,w]=(0,d.useState)(null);(0,d.useEffect)(()=>{w(null)},[s]),(0,d.useEffect)(()=>{null===y&&!v&&(c?.equippedPetId?w(c.equippedPetId):l.length>0&&w(l[0].pet.id))},[c,l,v]);let j=f.find(e=>e.id===y),N=l.find(e=>e.pet.id===y),S=!N,k=N?.exp||0,T=j?.evolutionRequiredExp||0,_=S||!j?0:T,I=(0,d.useMemo)(()=>j?{stage:j.evolutionStage,name:j.name,description:j.description,image:j.actualImgUrl,maxExp:T}:null,[j,T]),E=0!==_&&k>=_,C=(0,d.useCallback)(async()=>{if(!N)return void alert("보유하지 않은 펫입니다!");try{if(E){let e=await m(N.id);w(e.pet.id);try{await u(e.pet.id)}catch(e){console.error("Auto-equip failed after evolution:",e)}}else await h(N.id)}catch(e){alert("작업 실패: "+e)}},[N,E,m,u,h]),M=(0,d.useCallback)(async e=>{if(b(),0===l.length){w(e);try{await u(e)}catch(e){console.error("Auto-equip first pet failed:",e)}}},[b,l.length,u]),P=(0,d.useCallback)(async()=>{let e=await x();return{pet:e.userPet.pet,isDuplicate:e.isDuplicate}},[x]),D=(0,d.useCallback)(async e=>{if(w(e),n)try{await u(e)}catch(e){console.error("Failed to equip pet:",e)}},[n,u]),A=(0,d.useMemo)(()=>{let e=f.filter(e=>1===e.evolutionStage).map(e=>e.id);return 0!==e.length&&e.every(e=>o.includes(e))},[f,o]);if(!s||0===f.length&&v)return(0,a.jsx)("div",{children:"Loading..."});let R=c?.totalPoint??0;return(0,a.jsxs)("div",{className:"flex h-auto flex-col gap-4 text-amber-900",children:[(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(ec,{})}),I?(0,a.jsx)(en,{exp:k,maxExp:_,currentStageData:I,onAction:C,isOwner:n,points:R}):(0,a.jsxs)("div",{className:"border-4 border-amber-900/20 bg-amber-50 p-8 text-center text-amber-700",children:[(0,a.jsx)("p",{className:"text-lg font-bold",children:"보유한 펫이 없습니다"}),n&&(0,a.jsx)("p",{className:"text-sm",children:"아래에서 새로운 펫을 받아보세요!"})]}),n&&(0,a.jsx)(ei,{onGacha:P,onGachaRefund:g,onPetCollected:M,points:R,hasCollectedAllStage1:A}),(0,a.jsx)(el,{allPets:f,collectedPetIds:o,equippedPetId:y||-1,onPetSelect:D,isOwner:n})]})}let eh="border-3 border-amber-900";function em(){let{activeModal:e,userInfoPayload:t,closeModal:s}=(0,r.K)((0,x.k)(e=>({activeModal:e.activeModal,userInfoPayload:e.userInfoPayload,closeModal:e.closeModal}))),l=e===r.e.USER_INFO,o=t?.username,[c,h]=(0,d.useState)("activity"),{user:m}=(0,i.n)(),{player:u}=p(t?.playerId??0),g=m?.playerId===t?.playerId,b=u?.totalPoint??0,f=(0,d.useCallback)(()=>{s(),h("activity")},[s]),{contentRef:v,handleClose:y,handleBackdropClick:j}=(0,n.T)({isOpen:l,onClose:f});return l?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-10",onClick:j,children:(0,a.jsxs)("div",{id:"user-info-modal",ref:v,className:`modal-w:max-w-4xl modal-w:min-w-[850px] relative w-full max-w-2xl min-w-0 bg-[#ffecb3] ${eh} p-3 shadow-[8px_8px_0px_0px_rgba(0,0,0,0.5)]`,children:[(0,a.jsxs)("div",{className:"mb-4 flex items-start justify-between",children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("h2",{className:"text-xl font-extrabold tracking-wider text-amber-900",children:o})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[g&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex items-center gap-2 rounded border-2 border-amber-900/20 bg-amber-100 px-3 py-1 font-bold text-amber-800",children:(0,a.jsxs)("span",{children:[b.toLocaleString()," P"]})})}),(0,a.jsx)("button",{onClick:y,className:`flex h-8 w-8 cursor-pointer items-center justify-center ${eh} bg-red-400 leading-none font-bold text-white shadow-[2px_2px_0px_0px_rgba(30,30,30,0.3)] hover:bg-red-500 active:translate-x-[2px] active:translate-y-[2px] active:shadow-none`,children:"X"})]})]}),(0,a.jsxs)("div",{className:"mb-0 flex gap-1",children:[(0,a.jsx)(eu,{label:"활동",isActive:"activity"===c,onClick:()=>h("activity")}),(0,a.jsx)(eu,{id:"pet-tab-button",label:"펫",isActive:"pet"===c,onClick:()=>h("pet")}),(0,a.jsx)(eu,{label:"프로필",isActive:"profile"===c,onClick:()=>h("profile")})]}),(0,a.jsxs)("div",{className:`my-2 bg-white/50 p-4 ${eh} retro-scrollbar modal-content-height overflow-y-auto`,children:["profile"===c&&(0,a.jsx)(w,{}),"activity"===c&&(0,a.jsx)(et,{}),"pet"===c&&(0,a.jsx)(ed,{})]})]})}):null}function eu({id:e,label:t,isActive:s,onClick:r}){return(0,a.jsx)("button",{id:e,onClick:r,className:`flex-1 cursor-pointer py-2 text-sm font-bold transition-all ${eh} ${s?"bg-amber-600 text-white":"bg-amber-200 text-amber-900 hover:bg-amber-300"} ${s&&"hover:brightness-110"}`,children:t})}},9141:(e,t,s)=>{"use strict";s.d(t,{l:()=>a});let a={points:{all:["points"],list:e=>[...a.points.all,"list",e],gitEventHistories:(e,t)=>[...a.points.all,"gitEventHistories",e,t]},focustime:{all:["focustime"],detail:(e,t)=>[...a.focustime.all,e,t]},github:{all:["github"],events:(e,t)=>[...a.github.all,"events",e,t],user:e=>[...a.github.all,"user",e],followStatus:e=>[...a.github.all,"followStatus",e]},tasks:{all:["tasks"],list:(e,t)=>[...a.tasks.all,e,t]},pets:{all:["pets"],inventory:e=>[...a.pets.all,"inventory",e],codex:e=>[...a.pets.all,"codex",e],allPets:()=>[...a.pets.all,"all"]},player:{all:["player"],info:e=>[...a.player.all,"info",e]},leaderboard:{all:["leaderboard"],ranks:(e,t)=>[...a.leaderboard.all,"ranks",e,t]},rooms:{all:["rooms"]}}},9251:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});let a=(0,s(7122).v)(e=>({roomId:"",pendingRoomId:null,setRoomId:t=>e({roomId:t}),setPendingRoomId:t=>e({pendingRoomId:t})}))},9393:(e,t,s)=>{"use strict";s.d(t,{H$:()=>r,Zq:()=>n,hD:()=>i});var a=s(4902);let r="https://jandiplease.duckdns.org";class i extends Error{constructor(e,t,s){super(e),this.code=t,this.status=s,this.name="ApiError"}}async function n(e,t){try{let s=await fetch(`${r}${e}`,{...t,credentials:"include",headers:{"Content-Type":"application/json",...t?.headers}}),a=await s.text();if(!s.ok){let e;if(401===s.status)throw window.location.href="/login",new i("Unauthorized",void 0,401);let t=`API Error: ${s.status}`;if(a)try{let s=JSON.parse(a);s&&"object"==typeof s&&"string"==typeof s.code&&(e=s.code);let r=s&&"string"==typeof s&&s||s&&"object"==typeof s&&(s.message??s.error??s.detail);r&&(Array.isArray(r)?t+=` - ${r.join(", ")}`:"string"==typeof r?t+=` - ${r}`:t+=` - ${JSON.stringify(r)}`)}catch{let e=a.length>200?`${a.slice(0,197)}...`:a;t+=` - ${e}`}throw new i(t,e,s.status)}return a?JSON.parse(a):{}}catch(s){throw a.K.error("fetchApi failed",{endpoint:e,method:t?.method??"GET",error:s}),s}}},9873:(e,t,s)=>{"use strict";s.d(t,{n:()=>n});var a=s(7122),r=s(4902);let i="https://jandiplease.duckdns.org",n=(0,a.v)(e=>({user:null,isLoading:!0,isAuthenticated:!1,fetchUser:async()=>{try{e({isLoading:!0});let t=await fetch(`${i}/auth/me`,{credentials:"include"});if(t.ok){let s=await t.json();e({user:s,isAuthenticated:!0,isLoading:!1})}else e({user:null,isAuthenticated:!1,isLoading:!1})}catch(t){r.K.error("Failed to fetch user",{error:t}),e({user:null,isAuthenticated:!1,isLoading:!1})}},logout:()=>{window.location.href=`${i}/auth/logout`}}))}},e=>{e.O(0,[536,612,438,363,580,758,358],()=>e(e.s=9008)),_N_E=e.O()}]);